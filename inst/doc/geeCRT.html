<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Hengshi Yu, Fan Li, Paul Rathouz, Elizabeth L. Turner, John Preisser" />

<meta name="date" content="2024-02-18" />

<title>geeCRT package</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">geeCRT package</h1>
<h4 class="author">Hengshi Yu, Fan Li, Paul Rathouz, Elizabeth L.
Turner, John Preisser</h4>
<h4 class="date">2024-02-18</h4>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p>geeCRT is an R package for implementing the bias-corrected
generalized estimating equations in analyzing cluster randomized
trials.</p>
<p>Population-averaged models have been increasingly used in the design
and analysis of cluster randomized trials (CRTs). To facilitate the
applications of population-averaged models in CRTs, we implement the
generalized estimating equations (GEE) and matrix-adjusted estimating
equations (MAEE) approaches to jointly estimate the marginal mean models
correlation models both for general CRTs and stepped wedge CRTs.</p>
<p>Despite the general GEE/MAEE approach, we also implement a fast
cluster-period GEE method specifically for stepped wedge CRTs with large
and variable cluster-period sizes. The individual-level GEE/MAEE
approach becomes computationally infeasible in this setting due to
inversion of high-dimensional covariance matrices and the enumeration of
a high-dimensional design matrix for the correlation estimation
equations. The package gives a simple and efficient estimating equations
approach based on the cluster-period means to estimate the intervention
effects as well as correlation parameters.</p>
<p>In addition, the package also provides functions for generating
correlated binary data with specific mean vector and correlation matrix
based on the multivariate probit method <span class="citation">(Emrich
and Piedmonte 1991)</span> or the conditional linear family method <span class="citation">(Qaqish 2003)</span>. These two functions facilitate
generating correlated binary data in future simulation studies.</p>
</div>
<div id="geemaee-examples-matrix-adjusted-gee-for-estimating-the-mean-and-correlation-parameters-in-sw-crts" class="section level2">
<h2><code>geemaee()</code> examples: matrix-adjusted GEE for estimating
the mean and correlation parameters in SW-CRTs</h2>
<p>The <code>geemaee()</code> function implements the matrix-adjusted
GEE or regular GEE developed for analyzing cluster randomized trials
(CRTs). It provides valid estimation and inference for the treatment
effect and intraclass correlation parameters within the
population-averaged modeling framework. The program allows for flexible
marginal mean model specifications. The program also offers
bias-corrected intraclass correlation coefficient (ICC) estimates as
well as bias-corrected sandwich variances for both the treatment effect
parameter and the ICC parameters. The technical details of the
matrix-adjusted GEE approach are provided in <span class="citation">(Preisser, Lu, and Qaqish 2008)</span> and <span class="citation">(Li, Turner, and Preisser 2018)</span>.</p>
<p>For the individual-level data, we use the <code>geemaee()</code>
function to estimate the marginal mean and correlation parameters in
CRTs. We use two simulated stepped wedge CRT datasets with true nested
exchangeable correlation structure to illustrate the
<code>geemaee()</code> function examples.</p>
<div id="simulated-dataset-with-12-clusters-and-4-periods" class="section level3">
<h3>Simulated dataset with 12 clusters and 4 periods</h3>
<table>
<colgroup>
<col width="11%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
<col width="14%" />
<col width="4%" />
<col width="10%" />
<col width="8%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">period1</th>
<th align="right">period2</th>
<th align="right">period3</th>
<th align="right">period4</th>
<th align="right">treatment</th>
<th align="right">id</th>
<th align="right">period</th>
<th align="right">y_bin</th>
<th align="right">y_con</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">-0.5728721</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1.0462372</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.6033255</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">-0.8680703</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">-1.8845704</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">-0.5572751</td>
</tr>
</tbody>
</table>
<p>We first create an auxiliary function <code>createzCrossSec()</code>
to help create the design matrix for the estimating equations of the
correlation parameters assuming that the correlations follow a nested
exchangeable structure. We then collect design matrix <code>X</code> for
the mean parameters with five period indicators and the treatment
indicator.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># Z matrix for nested exchangeable correlation structure</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>createzCrossSec <span class="ot">&lt;-</span> <span class="cf">function</span>(m) {</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  Z <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">dim</span>(m)[<span class="dv">1</span>]</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>    alpha_0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>    alpha_1 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>    n_i <span class="ot">&lt;-</span> <span class="fu">c</span>(m[i, ])</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>    n_length <span class="ot">&lt;-</span> <span class="fu">length</span>(n_i)</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>    POS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(alpha_1, <span class="fu">sum</span>(n_i), <span class="fu">sum</span>(n_i))</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>    loc1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>    loc2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>    <span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_length) {</span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>      n_t <span class="ot">&lt;-</span> n_i[s]</span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>      loc1 <span class="ot">&lt;-</span> loc2 <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>      loc2 <span class="ot">&lt;-</span> loc1 <span class="sc">+</span> n_t <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a>      <span class="cf">for</span> (k <span class="cf">in</span> loc1<span class="sc">:</span>loc2) {</span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a>        <span class="cf">for</span> (j <span class="cf">in</span> loc1<span class="sc">:</span>loc2) {</span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a>          <span class="cf">if</span> (k <span class="sc">!=</span> j) {</span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a>            POS[k, j] <span class="ot">&lt;-</span> alpha_0</span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a>          } <span class="cf">else</span> {</span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a>            POS[k, j] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb1-26"><a href="#cb1-26" tabindex="-1"></a>          }</span>
<span id="cb1-27"><a href="#cb1-27" tabindex="-1"></a>        }</span>
<span id="cb1-28"><a href="#cb1-28" tabindex="-1"></a>      }</span>
<span id="cb1-29"><a href="#cb1-29" tabindex="-1"></a>    }</span>
<span id="cb1-30"><a href="#cb1-30" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" tabindex="-1"></a>    zrow <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">2</span>)</span>
<span id="cb1-32"><a href="#cb1-32" tabindex="-1"></a>    z_c <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb1-33"><a href="#cb1-33" tabindex="-1"></a></span>
<span id="cb1-34"><a href="#cb1-34" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">sum</span>(n_i) <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb1-35"><a href="#cb1-35" tabindex="-1"></a>      <span class="cf">for</span> (k <span class="cf">in</span> (j <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">sum</span>(n_i)) {</span>
<span id="cb1-36"><a href="#cb1-36" tabindex="-1"></a>        z_c <span class="ot">&lt;-</span> <span class="fu">rbind</span>(z_c, zrow[POS[j, k], ])</span>
<span id="cb1-37"><a href="#cb1-37" tabindex="-1"></a>      }</span>
<span id="cb1-38"><a href="#cb1-38" tabindex="-1"></a>    }</span>
<span id="cb1-39"><a href="#cb1-39" tabindex="-1"></a></span>
<span id="cb1-40"><a href="#cb1-40" tabindex="-1"></a>    Z <span class="ot">&lt;-</span> <span class="fu">rbind</span>(Z, z_c)</span>
<span id="cb1-41"><a href="#cb1-41" tabindex="-1"></a>  }</span>
<span id="cb1-42"><a href="#cb1-42" tabindex="-1"></a></span>
<span id="cb1-43"><a href="#cb1-43" tabindex="-1"></a>  <span class="fu">return</span>(Z)</span>
<span id="cb1-44"><a href="#cb1-44" tabindex="-1"></a>}</span></code></pre></div>
<p>We implement the <code>geemaee()</code> function on continuous,
binary and count outcomes using the nested exchangeable correlation
structure, and consider both matrix-adjusted estimating equations (MAEE)
with <code>alpadj = TRUE</code> and uncorrected generalized estimating
equations (GEE) with <code>alpadj = FALSE</code>. We use the binary
outcome for the count outcome type of the <code>geemaee()</code>
function, and consider both <code>poisson</code> and
<code>quasipoisson</code> distributions for the count outcome. For the
<code>shrink</code> argument, we use the <code>&quot;ALPHA&quot;</code> method to
tune step sizes and focus on using estimated variances in the
correlation estimating equations rather than using unit variances by
specifying <code>makevone = FALSE</code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="do">########################################################################</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="do">### Example 1): simulated SW-CRT with small cluster-period sizes (5~10)</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="do">########################################################################</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>sampleSWCRT <span class="ot">&lt;-</span> sampleSWCRTSmall</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="do">### Individual-level id, period, outcome, and design matrix</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>id <span class="ot">&lt;-</span> sampleSWCRT<span class="sc">$</span>id</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>period <span class="ot">&lt;-</span> sampleSWCRT<span class="sc">$</span>period</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(sampleSWCRT[, <span class="fu">c</span>(<span class="st">&quot;period1&quot;</span>, <span class="st">&quot;period2&quot;</span>, <span class="st">&quot;period3&quot;</span>, <span class="st">&quot;period4&quot;</span>, <span class="st">&quot;treatment&quot;</span>)])</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">table</span>(id, period))</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">dim</span>(m)[<span class="dv">1</span>]</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">dim</span>(m)[<span class="dv">2</span>]</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="do">### design matrix for correlation parameters</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">createzCrossSec</span>(m)</span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="do">### (1) Matrix-adjusted estimating equations and GEE</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="do">### on continuous outcome with nested exchangeable correlation structure</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="do">### MAEE</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a>est_maee_ind_con <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_con,</span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;continuous&quot;</span>,</span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">TRUE</span>,</span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a>)</span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a></span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a><span class="do">### GEE</span></span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a>est_uee_ind_con <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_con,</span>
<span id="cb2-33"><a href="#cb2-33" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb2-34"><a href="#cb2-34" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;continuous&quot;</span>,</span>
<span id="cb2-35"><a href="#cb2-35" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb2-36"><a href="#cb2-36" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">FALSE</span>,</span>
<span id="cb2-37"><a href="#cb2-37" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb2-38"><a href="#cb2-38" tabindex="-1"></a>)</span>
<span id="cb2-39"><a href="#cb2-39" tabindex="-1"></a></span>
<span id="cb2-40"><a href="#cb2-40" tabindex="-1"></a><span class="do">### (2) Matrix-adjusted estimating equations and GEE</span></span>
<span id="cb2-41"><a href="#cb2-41" tabindex="-1"></a><span class="do">### on binary outcome with nested exchangeable correlation structure</span></span>
<span id="cb2-42"><a href="#cb2-42" tabindex="-1"></a></span>
<span id="cb2-43"><a href="#cb2-43" tabindex="-1"></a><span class="do">### MAEE</span></span>
<span id="cb2-44"><a href="#cb2-44" tabindex="-1"></a>est_maee_ind_bin <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb2-45"><a href="#cb2-45" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_bin,</span>
<span id="cb2-46"><a href="#cb2-46" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb2-47"><a href="#cb2-47" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb2-48"><a href="#cb2-48" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb2-49"><a href="#cb2-49" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">TRUE</span>,</span>
<span id="cb2-50"><a href="#cb2-50" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb2-51"><a href="#cb2-51" tabindex="-1"></a>)</span>
<span id="cb2-52"><a href="#cb2-52" tabindex="-1"></a></span>
<span id="cb2-53"><a href="#cb2-53" tabindex="-1"></a><span class="do">### GEE</span></span>
<span id="cb2-54"><a href="#cb2-54" tabindex="-1"></a>est_uee_ind_bin <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb2-55"><a href="#cb2-55" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_bin,</span>
<span id="cb2-56"><a href="#cb2-56" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb2-57"><a href="#cb2-57" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb2-58"><a href="#cb2-58" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb2-59"><a href="#cb2-59" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">FALSE</span>,</span>
<span id="cb2-60"><a href="#cb2-60" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb2-61"><a href="#cb2-61" tabindex="-1"></a>)</span>
<span id="cb2-62"><a href="#cb2-62" tabindex="-1"></a></span>
<span id="cb2-63"><a href="#cb2-63" tabindex="-1"></a></span>
<span id="cb2-64"><a href="#cb2-64" tabindex="-1"></a><span class="do">### (3) Matrix-adjusted estimating equations and GEE</span></span>
<span id="cb2-65"><a href="#cb2-65" tabindex="-1"></a><span class="do">### on count outcome with nested exchangeable correlation structure</span></span>
<span id="cb2-66"><a href="#cb2-66" tabindex="-1"></a><span class="do">### using Poisson distribution</span></span>
<span id="cb2-67"><a href="#cb2-67" tabindex="-1"></a></span>
<span id="cb2-68"><a href="#cb2-68" tabindex="-1"></a><span class="do">### MAEE</span></span>
<span id="cb2-69"><a href="#cb2-69" tabindex="-1"></a>est_maee_ind_cnt_poisson <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb2-70"><a href="#cb2-70" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_bin,</span>
<span id="cb2-71"><a href="#cb2-71" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb2-72"><a href="#cb2-72" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;poisson&quot;</span>,</span>
<span id="cb2-73"><a href="#cb2-73" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb2-74"><a href="#cb2-74" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">TRUE</span>,</span>
<span id="cb2-75"><a href="#cb2-75" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb2-76"><a href="#cb2-76" tabindex="-1"></a>)</span>
<span id="cb2-77"><a href="#cb2-77" tabindex="-1"></a></span>
<span id="cb2-78"><a href="#cb2-78" tabindex="-1"></a><span class="do">### GEE</span></span>
<span id="cb2-79"><a href="#cb2-79" tabindex="-1"></a>est_uee_ind_cnt_poisson <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb2-80"><a href="#cb2-80" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_bin,</span>
<span id="cb2-81"><a href="#cb2-81" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb2-82"><a href="#cb2-82" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;poisson&quot;</span>,</span>
<span id="cb2-83"><a href="#cb2-83" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb2-84"><a href="#cb2-84" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">FALSE</span>,</span>
<span id="cb2-85"><a href="#cb2-85" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb2-86"><a href="#cb2-86" tabindex="-1"></a>)</span>
<span id="cb2-87"><a href="#cb2-87" tabindex="-1"></a></span>
<span id="cb2-88"><a href="#cb2-88" tabindex="-1"></a></span>
<span id="cb2-89"><a href="#cb2-89" tabindex="-1"></a><span class="do">### (4) Matrix-adjusted estimating equations and GEE</span></span>
<span id="cb2-90"><a href="#cb2-90" tabindex="-1"></a><span class="do">### on count outcome with nested exchangeable correlation structure</span></span>
<span id="cb2-91"><a href="#cb2-91" tabindex="-1"></a><span class="do">### using Quasi-Poisson distribution</span></span>
<span id="cb2-92"><a href="#cb2-92" tabindex="-1"></a></span>
<span id="cb2-93"><a href="#cb2-93" tabindex="-1"></a><span class="do">### MAEE</span></span>
<span id="cb2-94"><a href="#cb2-94" tabindex="-1"></a>est_maee_ind_cnt_quasipoisson <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb2-95"><a href="#cb2-95" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_bin,</span>
<span id="cb2-96"><a href="#cb2-96" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb2-97"><a href="#cb2-97" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;quasipoisson&quot;</span>,</span>
<span id="cb2-98"><a href="#cb2-98" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb2-99"><a href="#cb2-99" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">TRUE</span>,</span>
<span id="cb2-100"><a href="#cb2-100" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb2-101"><a href="#cb2-101" tabindex="-1"></a>)</span>
<span id="cb2-102"><a href="#cb2-102" tabindex="-1"></a></span>
<span id="cb2-103"><a href="#cb2-103" tabindex="-1"></a><span class="do">### GEE</span></span>
<span id="cb2-104"><a href="#cb2-104" tabindex="-1"></a>est_uee_ind_cnt_quasipoisson <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb2-105"><a href="#cb2-105" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_bin,</span>
<span id="cb2-106"><a href="#cb2-106" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb2-107"><a href="#cb2-107" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;quasipoisson&quot;</span>,</span>
<span id="cb2-108"><a href="#cb2-108" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb2-109"><a href="#cb2-109" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">FALSE</span>,</span>
<span id="cb2-110"><a href="#cb2-110" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb2-111"><a href="#cb2-111" tabindex="-1"></a>)</span></code></pre></div>
<p>Then we have the following output for continuous and binary
outcomes:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># MAEE for continuous outcome</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">print</span>(est_maee_ind_con)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 6 
## Results for marginal mean parameters 
##      Beta   Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0  0.1563400 0.1233724 0.11343910  0.1185200  0.1238356  0.1185676
## [2,]    1  0.2598417 0.1396584 0.15564306  0.1665805  0.1783248  0.1655108
## [3,]    2  0.2750434 0.1744216 0.09769357  0.1056224  0.1143643  0.1037000
## [4,]    3  0.3265847 0.2269849 0.20527795  0.2202021  0.2363784  0.2191884
## [5,]    4 -0.1846654 0.1916254 0.14636555  0.1592412  0.1733169  0.1587060
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.07335831  0.0385460 0.04035981 0.04226387 0.04042324
## [2,]     1 0.03210581  0.0160329 0.01683282 0.01767569 0.01684501</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># GEE for continuous outcome</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">print</span>(est_uee_ind_con)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 4 
## Results for marginal mean parameters 
##      Beta   Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0  0.1558990 0.1174052 0.11335326  0.1184565  0.1237977  0.1185069
## [2,]    1  0.2600341 0.1331291 0.15660456  0.1676591  0.1795345  0.1666850
## [3,]    2  0.2744039 0.1658703 0.09732366  0.1052335  0.1139553  0.1035272
## [4,]    3  0.3294253 0.2163095 0.20723038  0.2223924  0.2388282  0.2219057
## [5,]    4 -0.1857484 0.1828737 0.14726062  0.1602631  0.1744810  0.1599123
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.05304519 0.03055184 0.03200002 0.03352079 0.03204680
## [2,]     1 0.03019984 0.01459571 0.01532844 0.01610073 0.01533637</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># MAEE for binary outcome</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">print</span>(est_maee_ind_bin)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 7 
## Results for marginal mean parameters 
##      Beta   Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0 -0.7731496 0.2861811  0.2397046  0.2507701  0.2623524  0.2528516
## [2,]    1 -0.5067925 0.3163229  0.3125495  0.3364462  0.3626966  0.3340832
## [3,]    2 -0.6159656 0.4107850  0.5793391  0.6398733  0.7076154  0.6341025
## [4,]    3 -0.5932682 0.5956314  0.5498687  0.6043812  0.6650312  0.6087172
## [5,]    4 -0.9959081 0.4904630  0.5373051  0.5918909  0.6525862  0.5889413
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.09615638 0.03212815 0.03375024 0.03546144 0.03373575
## [2,]     1 0.03369215 0.03077853 0.03223000 0.03375486 0.03224127</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># GEE for binary outcome</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="fu">print</span>(est_uee_ind_bin)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 4 
## Results for marginal mean parameters 
##      Beta   Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0 -0.7716253 0.2693959  0.2404336  0.2516128  0.2633193  0.2537330
## [2,]    1 -0.5040824 0.2983658  0.3111895  0.3349180  0.3609889  0.3328046
## [3,]    2 -0.6329007 0.3872258  0.5796856  0.6406367  0.7089294  0.6350176
## [4,]    3 -0.5905097 0.5625779  0.5551809  0.6102428  0.6715582  0.6149354
## [5,]    4 -0.9942493 0.4649278  0.5404357  0.5954360  0.6566581  0.5926395
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.06909291 0.02771682 0.02909958 0.03055802 0.02908517
## [2,]     1 0.03017185 0.02749985 0.02879600 0.03015777 0.02880640</code></pre>
<p>In addition, we have the following output for count outcomes using
Poisson and Quasi-Poisson distributions:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># MAEE for count outcome using Poisson distribution</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">print</span>(est_maee_ind_cnt_poisson)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 6 
## Results for marginal mean parameters 
##      Beta   Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0 -1.1521619 0.3489214  0.1673871  0.1753755  0.1837532  0.1758285
## [2,]    1 -0.9604021 0.3518871  0.1762732  0.1890095  0.2028242  0.1881040
## [3,]    2 -1.1052655 0.5223114  0.4286854  0.4823239  0.5434271  0.4806275
## [4,]    3 -1.0109748 1.0115124  0.4402988  0.4845222  0.5343777  0.4839782
## [5,]    4 -0.7592537 0.8089485  0.4209105  0.4648193  0.5143975  0.4635516
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.06817046 0.02179020 0.02284202 0.02395004 0.02281778
## [2,]     1 0.02099757 0.02218181 0.02321486 0.02429979 0.02321545</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># GEE for count outcome using Poisson distribution</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">print</span>(est_uee_ind_cnt_poisson)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 5 
## Results for marginal mean parameters 
##      Beta   Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0 -1.1520612 0.3422800  0.1677249  0.1757617  0.1841923  0.1761798
## [2,]    1 -0.9599799 0.3443619  0.1757498  0.1884550  0.2022358  0.1875591
## [3,]    2 -1.1098392 0.5139263  0.4302872  0.4843235  0.5459324  0.4826701
## [4,]    3 -1.0107860 1.0016898  0.4414726  0.4858718  0.5359647  0.4852324
## [5,]    4 -0.7590982 0.8016988  0.4222038  0.4663158  0.5161605  0.4650724
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.04900710 0.01927730 0.02019439 0.02116040 0.02017570
## [2,]     1 0.01868904 0.01986653 0.02078916 0.02175808 0.02078932</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># MAEE for count outcome using Quasi-Poisson distribution</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="fu">print</span>(est_maee_ind_cnt_quasipoisson)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 8 
## Results for marginal mean parameters 
##      Beta   Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0 -1.1519918 0.3131953  0.1667100  0.1746142  0.1829002  0.1752801
## [2,]    1 -0.9589155 0.3160741  0.1767755  0.1895442  0.2033914  0.1887524
## [3,]    2 -1.1016110 0.4675363  0.4245096  0.4772228  0.5371973  0.4754787
## [4,]    3 -1.0117241 0.8967909  0.4369452  0.4806150  0.5297870  0.4802468
## [5,]    4 -0.7575391 0.7177545  0.4163786  0.4595912  0.5083364  0.4578985
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.09147181 0.03137139 0.03294759 0.03461028 0.03292827
## [2,]     1 0.03231153 0.02918904 0.03056169 0.03200342 0.03056347</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># GEE for count outcome using Quasi-Poisson distribution</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="fu">print</span>(est_uee_ind_cnt_quasipoisson)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 6 
## Results for marginal mean parameters 
##      Beta   Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0 -1.1518131 0.3055318  0.1671095  0.1750714  0.1834202  0.1756915
## [2,]    1 -0.9582190 0.3073944  0.1760662  0.1887880  0.2025830  0.1880073
## [3,]    2 -1.1073986 0.4578675  0.4265375  0.4797512  0.5403581  0.4780556
## [4,]    3 -1.0112083 0.8856530  0.4384607  0.4823527  0.5318224  0.4818385
## [5,]    4 -0.7575221 0.7095470  0.4179946  0.4614577  0.5105308  0.4597734
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.06509981 0.02703596 0.02837863 0.02979514 0.02836241
## [2,]     1 0.02868138 0.02603577 0.02725574 0.02853701 0.02725674</code></pre>
<p>We also consider the simple exchangeable correlation structure for
the cluster-period responses, where we specify the <code>Z</code> matrix
as a single column of 1’s. We implement the <code>geemaee()</code>
function on both the continuous outcome and binary outcome, and consider
both matrix-adjusted estimating equations (MAEE) with
<code>alpadj = TRUE</code> and uncorrected generalized estimating
equations (GEE) with <code>alpadj = FALSE</code>. For the
<code>shrink</code> argument, we use the <code>&quot;ALPHA&quot;</code> method to
tune step sizes and focus on using estimated variances in the
correlation estimating equations rather than using unit variances by
specifying <code>makevone = FALSE</code>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>sampleSWCRT <span class="ot">&lt;-</span> sampleSWCRTSmall</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="do">### Individual-level id, period, outcome, and design matrix</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>id <span class="ot">&lt;-</span> sampleSWCRT<span class="sc">$</span>id</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>period <span class="ot">&lt;-</span> sampleSWCRT<span class="sc">$</span>period</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(sampleSWCRT[, <span class="fu">c</span>(<span class="st">&quot;period1&quot;</span>, <span class="st">&quot;period2&quot;</span>, <span class="st">&quot;period3&quot;</span>, <span class="st">&quot;period4&quot;</span>, <span class="st">&quot;treatment&quot;</span>)])</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">table</span>(id, period))</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">dim</span>(m)[<span class="dv">1</span>]</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">dim</span>(m)[<span class="dv">2</span>]</span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a><span class="do">### design matrix for correlation parameters (simple exchangeable correlation structure)</span></span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">createzCrossSec</span>(m)</span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>, <span class="fu">dim</span>(Z)[<span class="dv">1</span>], <span class="dv">1</span>)</span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a></span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a><span class="do">### (1) Matrix-adjusted estimating equations and GEE</span></span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a><span class="do">### on continuous outcome with nested exchangeable correlation structure</span></span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" tabindex="-1"></a><span class="do">### MAEE</span></span>
<span id="cb19-19"><a href="#cb19-19" tabindex="-1"></a>est_maee_ind_con <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb19-20"><a href="#cb19-20" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_con,</span>
<span id="cb19-21"><a href="#cb19-21" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb19-22"><a href="#cb19-22" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;continuous&quot;</span>,</span>
<span id="cb19-23"><a href="#cb19-23" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb19-24"><a href="#cb19-24" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">TRUE</span>,</span>
<span id="cb19-25"><a href="#cb19-25" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb19-26"><a href="#cb19-26" tabindex="-1"></a>)</span>
<span id="cb19-27"><a href="#cb19-27" tabindex="-1"></a></span>
<span id="cb19-28"><a href="#cb19-28" tabindex="-1"></a><span class="do">### GEE</span></span>
<span id="cb19-29"><a href="#cb19-29" tabindex="-1"></a>est_uee_ind_con <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb19-30"><a href="#cb19-30" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_con,</span>
<span id="cb19-31"><a href="#cb19-31" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb19-32"><a href="#cb19-32" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;continuous&quot;</span>,</span>
<span id="cb19-33"><a href="#cb19-33" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb19-34"><a href="#cb19-34" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">FALSE</span>,</span>
<span id="cb19-35"><a href="#cb19-35" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb19-36"><a href="#cb19-36" tabindex="-1"></a>)</span>
<span id="cb19-37"><a href="#cb19-37" tabindex="-1"></a></span>
<span id="cb19-38"><a href="#cb19-38" tabindex="-1"></a><span class="do">### (2) Matrix-adjusted estimating equations and GEE</span></span>
<span id="cb19-39"><a href="#cb19-39" tabindex="-1"></a><span class="do">### on binary outcome with nested exchangeable correlation structure</span></span>
<span id="cb19-40"><a href="#cb19-40" tabindex="-1"></a></span>
<span id="cb19-41"><a href="#cb19-41" tabindex="-1"></a><span class="do">### MAEE</span></span>
<span id="cb19-42"><a href="#cb19-42" tabindex="-1"></a>est_maee_ind_bin <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb19-43"><a href="#cb19-43" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_bin,</span>
<span id="cb19-44"><a href="#cb19-44" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb19-45"><a href="#cb19-45" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb19-46"><a href="#cb19-46" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb19-47"><a href="#cb19-47" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">TRUE</span>,</span>
<span id="cb19-48"><a href="#cb19-48" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb19-49"><a href="#cb19-49" tabindex="-1"></a>)</span>
<span id="cb19-50"><a href="#cb19-50" tabindex="-1"></a></span>
<span id="cb19-51"><a href="#cb19-51" tabindex="-1"></a></span>
<span id="cb19-52"><a href="#cb19-52" tabindex="-1"></a><span class="do">### GEE</span></span>
<span id="cb19-53"><a href="#cb19-53" tabindex="-1"></a>est_uee_ind_bin <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb19-54"><a href="#cb19-54" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_bin,</span>
<span id="cb19-55"><a href="#cb19-55" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb19-56"><a href="#cb19-56" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb19-57"><a href="#cb19-57" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb19-58"><a href="#cb19-58" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">FALSE</span>,</span>
<span id="cb19-59"><a href="#cb19-59" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb19-60"><a href="#cb19-60" tabindex="-1"></a>)</span></code></pre></div>
<p>Then we have the following output:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co"># MAEE for continuous outcome</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="fu">print</span>(est_maee_ind_con)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 6 
## Results for marginal mean parameters 
##      Beta   Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0  0.1546654 0.1138036  0.1132300  0.1183400  0.1236901  0.1183735
## [2,]    1  0.2575634 0.1286791  0.1577178  0.1688563  0.1808451  0.1686030
## [3,]    2  0.2655184 0.1588560  0.1005199  0.1085032  0.1172738  0.1091556
## [4,]    3  0.3254756 0.2066790  0.2188951  0.2353741  0.2532413  0.2385154
## [5,]    4 -0.1803555 0.1738138  0.1555551  0.1694989  0.1847540  0.1700911
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.04161855 0.01626681 0.01707934   0.017935 0.01710478</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="co"># GEE for continuous outcome</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="fu">print</span>(est_uee_ind_con)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 4 
## Results for marginal mean parameters 
##      Beta   Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0  0.1548400 0.1119522  0.1132388  0.1183621  0.1237270  0.1184054
## [2,]    1  0.2586067 0.1269062  0.1578532  0.1690319  0.1810577  0.1685156
## [3,]    2  0.2685238 0.1570543  0.0989460  0.1068758  0.1155986  0.1066848
## [4,]    3  0.3288218 0.2048429  0.2153506  0.2314405  0.2488849  0.2334599
## [5,]    4 -0.1832029 0.1728612  0.1526576  0.1662888  0.1812008  0.1665749
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.03563676  0.0145224 0.01524472 0.01600543 0.01526096</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="co"># MAEE for binary outcome</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="fu">print</span>(est_maee_ind_bin)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 6 
## Results for marginal mean parameters 
##      Beta   Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0 -0.7680520 0.2551979  0.2402408  0.2515042  0.2633056  0.2560060
## [2,]    1 -0.4922456 0.2801734  0.3139606  0.3377667  0.3639014  0.3395136
## [3,]    2 -0.6703178 0.3598533  0.5664151  0.6258843  0.6926011  0.6241206
## [4,]    3 -0.5918583 0.5167021  0.5636072  0.6189357  0.6805468  0.6320340
## [5,]    4 -0.9783470 0.4282247  0.5386478  0.5930714  0.6537034  0.5930284
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.04820458 0.02878404 0.03018486  0.0316581 0.03021869</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="co"># GEE for binary outcome</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a><span class="fu">print</span>(est_uee_ind_bin)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 4 
## Results for marginal mean parameters 
##      Beta   Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0 -0.7682900 0.2492772  0.2407543  0.2520694  0.2639264  0.2557018
## [2,]    1 -0.4935666 0.2750558  0.3121951  0.3358868  0.3619068  0.3364044
## [3,]    2 -0.6710571 0.3546461  0.5707372  0.6310024  0.6986599  0.6278109
## [4,]    3 -0.5894580 0.5122764  0.5645206  0.6201814  0.6822145  0.6305004
## [5,]    4 -0.9820253 0.4257111  0.5412118  0.5961231  0.6573418  0.5951026
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.03937419 0.02544412 0.02668884 0.02799821 0.02670961</code></pre>
</div>
<div id="simulated-dataset-with-12-clusters-and-5-periods" class="section level3">
<h3>Simulated dataset with 12 clusters and 5 periods</h3>
<table>
<colgroup>
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="12%" />
<col width="3%" />
<col width="9%" />
<col width="7%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">period1</th>
<th align="right">period2</th>
<th align="right">period3</th>
<th align="right">period4</th>
<th align="right">period5</th>
<th align="right">treatment</th>
<th align="right">id</th>
<th align="right">period</th>
<th align="right">y_bin</th>
<th align="right">y_con</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.6789756</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.3776961</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">-0.5519475</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">-1.3102658</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.2654200</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">-0.3327958</td>
</tr>
</tbody>
</table>
<p>Using the nested exchangeable correlation structure, we have the
following results.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="do">########################################################################</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a><span class="do">### Example 2): simulated SW-CRT with larger cluster-period sizes (20~30)</span></span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a><span class="do">########################################################################</span></span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a><span class="do">## This will elapse longer.</span></span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>sampleSWCRT <span class="ot">&lt;-</span> sampleSWCRTLarge</span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a><span class="do">### Individual-level id, period, outcome, and design matrix</span></span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a>id <span class="ot">&lt;-</span> sampleSWCRT<span class="sc">$</span>id</span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a>period <span class="ot">&lt;-</span> sampleSWCRT<span class="sc">$</span>period</span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(sampleSWCRT[, <span class="fu">c</span>(<span class="st">&quot;period1&quot;</span>, <span class="st">&quot;period2&quot;</span>, <span class="st">&quot;period3&quot;</span>, <span class="st">&quot;period4&quot;</span>, <span class="st">&quot;period5&quot;</span>, <span class="st">&quot;treatment&quot;</span>)])</span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">table</span>(id, period))</span>
<span id="cb28-13"><a href="#cb28-13" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">dim</span>(m)[<span class="dv">1</span>]</span>
<span id="cb28-14"><a href="#cb28-14" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">dim</span>(m)[<span class="dv">2</span>]</span>
<span id="cb28-15"><a href="#cb28-15" tabindex="-1"></a><span class="do">### design matrix for correlation parameters</span></span>
<span id="cb28-16"><a href="#cb28-16" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">createzCrossSec</span>(m)</span>
<span id="cb28-17"><a href="#cb28-17" tabindex="-1"></a></span>
<span id="cb28-18"><a href="#cb28-18" tabindex="-1"></a><span class="do">### (1) Matrix-adjusted estimating equations and GEE</span></span>
<span id="cb28-19"><a href="#cb28-19" tabindex="-1"></a><span class="do">### on continous outcome with nested exchangeable correlation structure</span></span>
<span id="cb28-20"><a href="#cb28-20" tabindex="-1"></a></span>
<span id="cb28-21"><a href="#cb28-21" tabindex="-1"></a><span class="do">### MAEE</span></span>
<span id="cb28-22"><a href="#cb28-22" tabindex="-1"></a>est_maee_ind_con <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb28-23"><a href="#cb28-23" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_con,</span>
<span id="cb28-24"><a href="#cb28-24" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb28-25"><a href="#cb28-25" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;continuous&quot;</span>,</span>
<span id="cb28-26"><a href="#cb28-26" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb28-27"><a href="#cb28-27" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">TRUE</span>,</span>
<span id="cb28-28"><a href="#cb28-28" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb28-29"><a href="#cb28-29" tabindex="-1"></a>)</span>
<span id="cb28-30"><a href="#cb28-30" tabindex="-1"></a><span class="fu">print</span>(est_maee_ind_con)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 6 
## Results for marginal mean parameters 
##      Beta    Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0  0.19231933 0.1048518 0.13134291 0.13722549 0.14337189 0.13681137
## [2,]    1  0.13855318 0.1089971 0.08559214 0.09070281 0.09631631 0.08746208
## [3,]    2  0.14135330 0.1246032 0.09471802 0.10092099 0.10769442 0.10114962
## [4,]    3  0.20421027 0.1452583 0.10146597 0.11068698 0.12096977 0.11160100
## [5,]    4  0.24716971 0.1684305 0.17177784 0.18728285 0.20433337 0.18746260
## [6,]    5 -0.08406266 0.1322349 0.13858326 0.15310151 0.16917367 0.15161045
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.09465688 0.02442148 0.02594067 0.02764751 0.02572805
## [2,]     1 0.03469533 0.01939519 0.02047886 0.02163615 0.02033902</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="do">### GEE</span></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>est_uee_ind_con <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_con,</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;continuous&quot;</span>,</span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">FALSE</span>,</span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a>)</span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a><span class="fu">print</span>(est_uee_ind_con)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 4 
## Results for marginal mean parameters 
##      Beta    Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0  0.19190139 0.0996732 0.13145806  0.1373518  0.1435101  0.1369554
## [2,]    1  0.13814149 0.1035213 0.08569554  0.0908225  0.0964508  0.0875894
## [3,]    2  0.14064776 0.1185910 0.09464091  0.1008293  0.1075822  0.1010819
## [4,]    3  0.20346170 0.1383136 0.10102922  0.1101788  0.1203834  0.1111059
## [5,]    4  0.24633487 0.1602727 0.17211627  0.1876575  0.2047488  0.1878631
## [6,]    5 -0.08318282 0.1259570 0.13859217  0.1531209  0.1692063  0.1516836
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.08146407 0.02277749 0.02412259 0.02563971 0.02397541
## [2,]     1 0.03076420 0.01819528 0.01919418 0.02026185 0.01907859</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="do">### (2) Matrix-adjusted estimating equations and GEE</span></span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a><span class="do">### on binary outcome with nested exchangeable correlation structure</span></span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a><span class="do">### MAEE</span></span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>est_maee_ind_bin <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_bin,</span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">TRUE</span>,</span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb32-12"><a href="#cb32-12" tabindex="-1"></a>)</span>
<span id="cb32-13"><a href="#cb32-13" tabindex="-1"></a><span class="fu">print</span>(est_maee_ind_bin)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 7 
## Results for marginal mean parameters 
##      Beta    Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0 -0.03457213 0.2241538  0.2392075  0.2498653  0.2610001  0.2473707
## [2,]    1 -0.34208716 0.2377506  0.2099319  0.2248003  0.2408185  0.2234759
## [3,]    2 -0.67675480 0.2823888  0.2743190  0.2961203  0.3199988  0.2912959
## [4,]    3  0.02997130 0.3119529  0.2000433  0.2183246  0.2399443  0.2115277
## [5,]    4 -0.42930737 0.3863814  0.1803455  0.1973792  0.2176510  0.1991261
## [6,]    5 -0.81816822 0.2919980  0.2800864  0.3069737  0.3365978  0.3032212
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.11496936 0.04117568 0.04294094 0.04478275 0.04281833
## [2,]     1 0.06242691 0.03481106 0.03630878 0.03787122 0.03624330</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="do">### GEE</span></span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>est_uee_ind_bin <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_bin,</span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">FALSE</span>,</span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a>)</span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a><span class="fu">print</span>(est_uee_ind_bin)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 4 
## Results for marginal mean parameters 
##      Beta    Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0 -0.03532021 0.2130112  0.2391542  0.2498171  0.2609580  0.2472393
## [2,]    1 -0.34154512 0.2256323  0.2100181  0.2248984  0.2409307  0.2236170
## [3,]    2 -0.67644339 0.2683572  0.2745740  0.2964326  0.3203797  0.2916198
## [4,]    3  0.03090417 0.2963087  0.2002704  0.2186117  0.2403231  0.2117340
## [5,]    4 -0.43011798 0.3665889  0.1798608  0.1969091  0.2172283  0.1986538
## [6,]    5 -0.81865546 0.2768705  0.2801134  0.3070590  0.3367553  0.3032859
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.09974917 0.03709677 0.03868651 0.04034505 0.03857485
## [2,]     1 0.05686766 0.03128090 0.03262829 0.03403398 0.03256722</code></pre>
<p>Using the simple exchangeable correlation structure, we have the
following results.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>sampleSWCRT <span class="ot">&lt;-</span> sampleSWCRTLarge</span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a><span class="do">### Individual-level id, period, outcome, and design matrix</span></span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a>id <span class="ot">&lt;-</span> sampleSWCRT<span class="sc">$</span>id</span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a>period <span class="ot">&lt;-</span> sampleSWCRT<span class="sc">$</span>period</span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(sampleSWCRT[, <span class="fu">c</span>(<span class="st">&quot;period1&quot;</span>, <span class="st">&quot;period2&quot;</span>, <span class="st">&quot;period3&quot;</span>, <span class="st">&quot;period4&quot;</span>, <span class="st">&quot;period5&quot;</span>, <span class="st">&quot;treatment&quot;</span>)])</span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">table</span>(id, period))</span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">dim</span>(m)[<span class="dv">1</span>]</span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">dim</span>(m)[<span class="dv">2</span>]</span>
<span id="cb36-10"><a href="#cb36-10" tabindex="-1"></a><span class="do">### design matrix for correlation parameters</span></span>
<span id="cb36-11"><a href="#cb36-11" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">createzCrossSec</span>(m)</span>
<span id="cb36-12"><a href="#cb36-12" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>, <span class="fu">dim</span>(Z)[<span class="dv">1</span>], <span class="dv">1</span>)</span>
<span id="cb36-13"><a href="#cb36-13" tabindex="-1"></a></span>
<span id="cb36-14"><a href="#cb36-14" tabindex="-1"></a><span class="do">### (1) Matrix-adjusted estimating equations and GEE</span></span>
<span id="cb36-15"><a href="#cb36-15" tabindex="-1"></a><span class="do">### on continous outcome with nested exchangeable correlation structure</span></span>
<span id="cb36-16"><a href="#cb36-16" tabindex="-1"></a></span>
<span id="cb36-17"><a href="#cb36-17" tabindex="-1"></a><span class="do">### MAEE</span></span>
<span id="cb36-18"><a href="#cb36-18" tabindex="-1"></a>est_maee_ind_con <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb36-19"><a href="#cb36-19" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_con,</span>
<span id="cb36-20"><a href="#cb36-20" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb36-21"><a href="#cb36-21" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;continuous&quot;</span>,</span>
<span id="cb36-22"><a href="#cb36-22" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb36-23"><a href="#cb36-23" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">TRUE</span>,</span>
<span id="cb36-24"><a href="#cb36-24" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb36-25"><a href="#cb36-25" tabindex="-1"></a>)</span>
<span id="cb36-26"><a href="#cb36-26" tabindex="-1"></a><span class="fu">print</span>(est_maee_ind_con)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 5 
## Results for marginal mean parameters 
##      Beta    Estimate  MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0  0.18627032 0.08414604 0.13279197 0.13883272 0.14515097 0.13737503
## [2,]    1  0.13815534 0.08568755 0.08728350 0.09253851 0.09827924 0.08831436
## [3,]    2  0.14554680 0.09591310 0.09561107 0.10175525 0.10851515 0.10198254
## [4,]    3  0.20689929 0.10841530 0.09868192 0.10735199 0.11704766 0.10988201
## [5,]    4  0.25610889 0.12165483 0.17022286 0.18525460 0.20174120 0.19006405
## [6,]    5 -0.09300219 0.08850272 0.13636987 0.15009052 0.16522319 0.14914568
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.04611516  0.0213304 0.02261646  0.0239952  0.0222351</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="do">### GEE</span></span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a>est_uee_ind_con <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_con,</span>
<span id="cb38-4"><a href="#cb38-4" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb38-5"><a href="#cb38-5" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;continuous&quot;</span>,</span>
<span id="cb38-6"><a href="#cb38-6" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb38-7"><a href="#cb38-7" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">FALSE</span>,</span>
<span id="cb38-8"><a href="#cb38-8" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb38-9"><a href="#cb38-9" tabindex="-1"></a>)</span>
<span id="cb38-10"><a href="#cb38-10" tabindex="-1"></a><span class="fu">print</span>(est_uee_ind_con)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 4 
## Results for marginal mean parameters 
##      Beta    Estimate  MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0  0.18623550 0.08157593 0.13280807 0.13885009 0.14516968 0.13758490
## [2,]    1  0.13775315 0.08314994 0.08726205 0.09252299 0.09826906 0.08851174
## [3,]    2  0.14459742 0.09363651 0.09541116 0.10153431 0.10826320 0.10169514
## [4,]    3  0.20603548 0.10636160 0.09830339 0.10692622 0.11656789 0.10913963
## [5,]    4  0.25474380 0.11977319 0.17041119 0.18547805 0.20200601 0.18958752
## [6,]    5 -0.09160689 0.08834620 0.13623821 0.14998489 0.16515087 0.14894388
## 
## Results for correlation parameters 
##      Alpha  Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.0408165 0.02379864 0.02536501 0.02705457  0.0247663</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="do">### (2) Matrix-adjusted estimating equations and GEE</span></span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a><span class="do">### on binary outcome with nested exchangeable correlation structure</span></span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" tabindex="-1"></a><span class="do">### MAEE</span></span>
<span id="cb40-5"><a href="#cb40-5" tabindex="-1"></a>est_maee_ind_bin <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb40-6"><a href="#cb40-6" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_bin,</span>
<span id="cb40-7"><a href="#cb40-7" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb40-8"><a href="#cb40-8" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb40-9"><a href="#cb40-9" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb40-10"><a href="#cb40-10" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">TRUE</span>,</span>
<span id="cb40-11"><a href="#cb40-11" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb40-12"><a href="#cb40-12" tabindex="-1"></a>)</span>
<span id="cb40-13"><a href="#cb40-13" tabindex="-1"></a><span class="fu">print</span>(est_maee_ind_bin)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 5 
## Results for marginal mean parameters 
##      Beta    Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0 -0.03973392 0.1901734  0.2375264  0.2482506  0.2594763  0.2402294
## [2,]    1 -0.33441396 0.1969079  0.2191302  0.2343650  0.2508029  0.2379983
## [3,]    2 -0.67365821 0.2291302  0.2926954  0.3160152  0.3416383  0.3157696
## [4,]    3  0.04551938 0.2377877  0.2306274  0.2508583  0.2745651  0.2450061
## [5,]    4 -0.43406855 0.2864244  0.1708418  0.1874952  0.2077659  0.1954336
## [6,]    5 -0.82474970 0.1978452  0.2759903  0.3032872  0.3334597  0.3001580
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.07132474 0.03467243 0.03613621 0.03766221 0.03596639</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="do">### GEE</span></span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a>est_uee_ind_bin <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb42-3"><a href="#cb42-3" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_bin,</span>
<span id="cb42-4"><a href="#cb42-4" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb42-5"><a href="#cb42-5" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb42-6"><a href="#cb42-6" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb42-7"><a href="#cb42-7" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">FALSE</span>,</span>
<span id="cb42-8"><a href="#cb42-8" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb42-9"><a href="#cb42-9" tabindex="-1"></a>)</span>
<span id="cb42-10"><a href="#cb42-10" tabindex="-1"></a><span class="fu">print</span>(est_uee_ind_bin)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 4 
## Results for marginal mean parameters 
##      Beta    Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0 -0.04019172 0.1849222  0.2377030  0.2484296  0.2596563  0.2411474
## [2,]    1 -0.33482763 0.1916991  0.2182129  0.2334232  0.2498335  0.2363416
## [3,]    2 -0.67397738 0.2240146  0.2909303  0.3141572  0.3396799  0.3131966
## [4,]    3  0.04476860 0.2342217  0.2278055  0.2479068  0.2715079  0.2418171
## [5,]    4 -0.43477643 0.2828052  0.1707430  0.1874088  0.2076964  0.1944779
## [6,]    5 -0.82448172 0.1978906  0.2761830  0.3034841  0.3336617  0.3003341
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.06511568 0.03162665 0.03296549 0.03436137 0.03282115</code></pre>
</div>
</div>
<div id="geemaee-examples-matrix-adjusted-gee-for-estimating-the-mean-and-correlation-parameters-in-sw-crts-when-some-clusters-had-only-1-observation" class="section level2">
<h2><code>geemaee()</code> examples: matrix-adjusted GEE for estimating
the mean and correlation parameters in SW-CRTs when some clusters had
only 1 observation</h2>
<p>We can use the <code>geemaee()</code> function for SW-CRTs when some
clusters had only one observation.</p>
<div id="simulated-dataset-with-12-clusters-and-small-cluster-sizes" class="section level3">
<h3>Simulated dataset with 12 clusters and small cluster sizes</h3>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="do">## let the cluster 5 and cluster 10 be with only 1 observation</span></span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a>sampleSWCRT <span class="ot">&lt;-</span> sampleSWCRTSmall[sampleSWCRTSmall<span class="sc">$</span>id <span class="sc">!=</span> <span class="dv">5</span> <span class="sc">&amp;</span> sampleSWCRTSmall<span class="sc">$</span>id <span class="sc">!=</span> <span class="dv">10</span>, ]</span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a>sampleSWCRT5 <span class="ot">&lt;-</span> sampleSWCRTSmall[sampleSWCRTSmall<span class="sc">$</span>id <span class="sc">==</span> <span class="dv">5</span>, ][<span class="dv">1</span>, ]</span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a>sampleSWCRT10 <span class="ot">&lt;-</span> sampleSWCRTSmall[sampleSWCRTSmall<span class="sc">$</span>id <span class="sc">==</span> <span class="dv">10</span>, ][<span class="dv">1</span>, ]</span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a>sampleSWCRT <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sampleSWCRT, sampleSWCRT5)</span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a>sampleSWCRT <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sampleSWCRT, sampleSWCRT10)</span>
<span id="cb44-7"><a href="#cb44-7" tabindex="-1"></a>sampleSWCRT <span class="ot">&lt;-</span> sampleSWCRT[<span class="fu">order</span>(sampleSWCRT<span class="sc">$</span>id), ]</span>
<span id="cb44-8"><a href="#cb44-8" tabindex="-1"></a></span>
<span id="cb44-9"><a href="#cb44-9" tabindex="-1"></a>id <span class="ot">&lt;-</span> sampleSWCRT<span class="sc">$</span>id</span>
<span id="cb44-10"><a href="#cb44-10" tabindex="-1"></a>period <span class="ot">&lt;-</span> sampleSWCRT<span class="sc">$</span>period</span>
<span id="cb44-11"><a href="#cb44-11" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(sampleSWCRT[, <span class="fu">c</span>(<span class="st">&quot;period1&quot;</span>, <span class="st">&quot;period2&quot;</span>, <span class="st">&quot;period3&quot;</span>, <span class="st">&quot;period4&quot;</span>, <span class="st">&quot;treatment&quot;</span>)])</span>
<span id="cb44-12"><a href="#cb44-12" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">table</span>(id, period))</span>
<span id="cb44-13"><a href="#cb44-13" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">dim</span>(m)[<span class="dv">1</span>]</span>
<span id="cb44-14"><a href="#cb44-14" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">dim</span>(m)[<span class="dv">2</span>]</span>
<span id="cb44-15"><a href="#cb44-15" tabindex="-1"></a></span>
<span id="cb44-16"><a href="#cb44-16" tabindex="-1"></a><span class="do">## function to generate Z matrix (ignore the clusters with only 1 observation)</span></span>
<span id="cb44-17"><a href="#cb44-17" tabindex="-1"></a>createzCrossSecIgnoreOneObsCount <span class="ot">&lt;-</span> <span class="cf">function</span>(m) {</span>
<span id="cb44-18"><a href="#cb44-18" tabindex="-1"></a>  Z <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb44-19"><a href="#cb44-19" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">dim</span>(m)[<span class="dv">1</span>]</span>
<span id="cb44-20"><a href="#cb44-20" tabindex="-1"></a></span>
<span id="cb44-21"><a href="#cb44-21" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb44-22"><a href="#cb44-22" tabindex="-1"></a>    alpha_0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb44-23"><a href="#cb44-23" tabindex="-1"></a>    alpha_1 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb44-24"><a href="#cb44-24" tabindex="-1"></a>    n_i <span class="ot">&lt;-</span> <span class="fu">c</span>(m[i, ])</span>
<span id="cb44-25"><a href="#cb44-25" tabindex="-1"></a>    n_i <span class="ot">&lt;-</span> <span class="fu">c</span>(n_i[n_i <span class="sc">&gt;</span> <span class="dv">0</span>])</span>
<span id="cb44-26"><a href="#cb44-26" tabindex="-1"></a>    n_length <span class="ot">&lt;-</span> <span class="fu">length</span>(n_i)</span>
<span id="cb44-27"><a href="#cb44-27" tabindex="-1"></a>    POS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(alpha_1, <span class="fu">sum</span>(n_i), <span class="fu">sum</span>(n_i))</span>
<span id="cb44-28"><a href="#cb44-28" tabindex="-1"></a>    loc1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb44-29"><a href="#cb44-29" tabindex="-1"></a>    loc2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb44-30"><a href="#cb44-30" tabindex="-1"></a></span>
<span id="cb44-31"><a href="#cb44-31" tabindex="-1"></a>    <span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_length) {</span>
<span id="cb44-32"><a href="#cb44-32" tabindex="-1"></a>      n_t <span class="ot">&lt;-</span> n_i[s]</span>
<span id="cb44-33"><a href="#cb44-33" tabindex="-1"></a>      loc1 <span class="ot">&lt;-</span> loc2 <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb44-34"><a href="#cb44-34" tabindex="-1"></a>      loc2 <span class="ot">&lt;-</span> loc1 <span class="sc">+</span> n_t <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb44-35"><a href="#cb44-35" tabindex="-1"></a></span>
<span id="cb44-36"><a href="#cb44-36" tabindex="-1"></a>      <span class="cf">for</span> (k <span class="cf">in</span> loc1<span class="sc">:</span>loc2) {</span>
<span id="cb44-37"><a href="#cb44-37" tabindex="-1"></a>        <span class="cf">for</span> (j <span class="cf">in</span> loc1<span class="sc">:</span>loc2) {</span>
<span id="cb44-38"><a href="#cb44-38" tabindex="-1"></a>          <span class="cf">if</span> (k <span class="sc">!=</span> j) {</span>
<span id="cb44-39"><a href="#cb44-39" tabindex="-1"></a>            POS[k, j] <span class="ot">&lt;-</span> alpha_0</span>
<span id="cb44-40"><a href="#cb44-40" tabindex="-1"></a>          } <span class="cf">else</span> {</span>
<span id="cb44-41"><a href="#cb44-41" tabindex="-1"></a>            POS[k, j] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb44-42"><a href="#cb44-42" tabindex="-1"></a>          }</span>
<span id="cb44-43"><a href="#cb44-43" tabindex="-1"></a>        }</span>
<span id="cb44-44"><a href="#cb44-44" tabindex="-1"></a>      }</span>
<span id="cb44-45"><a href="#cb44-45" tabindex="-1"></a>    }</span>
<span id="cb44-46"><a href="#cb44-46" tabindex="-1"></a></span>
<span id="cb44-47"><a href="#cb44-47" tabindex="-1"></a>    zrow <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">2</span>)</span>
<span id="cb44-48"><a href="#cb44-48" tabindex="-1"></a>    z_c <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb44-49"><a href="#cb44-49" tabindex="-1"></a></span>
<span id="cb44-50"><a href="#cb44-50" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">sum</span>(n_i) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb44-51"><a href="#cb44-51" tabindex="-1"></a>      <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">sum</span>(n_i) <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb44-52"><a href="#cb44-52" tabindex="-1"></a>        <span class="cf">for</span> (k <span class="cf">in</span> (j <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">sum</span>(n_i)) {</span>
<span id="cb44-53"><a href="#cb44-53" tabindex="-1"></a>          z_c <span class="ot">&lt;-</span> <span class="fu">rbind</span>(z_c, zrow[POS[j, k], ])</span>
<span id="cb44-54"><a href="#cb44-54" tabindex="-1"></a>        }</span>
<span id="cb44-55"><a href="#cb44-55" tabindex="-1"></a>      }</span>
<span id="cb44-56"><a href="#cb44-56" tabindex="-1"></a>    }</span>
<span id="cb44-57"><a href="#cb44-57" tabindex="-1"></a></span>
<span id="cb44-58"><a href="#cb44-58" tabindex="-1"></a>    Z <span class="ot">&lt;-</span> <span class="fu">rbind</span>(Z, z_c)</span>
<span id="cb44-59"><a href="#cb44-59" tabindex="-1"></a>  }</span>
<span id="cb44-60"><a href="#cb44-60" tabindex="-1"></a></span>
<span id="cb44-61"><a href="#cb44-61" tabindex="-1"></a>  <span class="fu">return</span>(Z)</span>
<span id="cb44-62"><a href="#cb44-62" tabindex="-1"></a>}</span>
<span id="cb44-63"><a href="#cb44-63" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">createzCrossSecIgnoreOneObsCount</span>(m)</span>
<span id="cb44-64"><a href="#cb44-64" tabindex="-1"></a></span>
<span id="cb44-65"><a href="#cb44-65" tabindex="-1"></a><span class="do">### (1) Matrix-adjusted estimating equations and GEE</span></span>
<span id="cb44-66"><a href="#cb44-66" tabindex="-1"></a><span class="do">### on continuous outcome with nested exchangeable correlation structure</span></span>
<span id="cb44-67"><a href="#cb44-67" tabindex="-1"></a></span>
<span id="cb44-68"><a href="#cb44-68" tabindex="-1"></a><span class="do">### MAEE</span></span>
<span id="cb44-69"><a href="#cb44-69" tabindex="-1"></a>est_maee_ind_con <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb44-70"><a href="#cb44-70" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_con,</span>
<span id="cb44-71"><a href="#cb44-71" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb44-72"><a href="#cb44-72" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;continuous&quot;</span>,</span>
<span id="cb44-73"><a href="#cb44-73" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb44-74"><a href="#cb44-74" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">TRUE</span>,</span>
<span id="cb44-75"><a href="#cb44-75" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb44-76"><a href="#cb44-76" tabindex="-1"></a>)</span>
<span id="cb44-77"><a href="#cb44-77" tabindex="-1"></a></span>
<span id="cb44-78"><a href="#cb44-78" tabindex="-1"></a><span class="do">### GEE</span></span>
<span id="cb44-79"><a href="#cb44-79" tabindex="-1"></a>est_uee_ind_con <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb44-80"><a href="#cb44-80" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_con,</span>
<span id="cb44-81"><a href="#cb44-81" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb44-82"><a href="#cb44-82" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;continuous&quot;</span>,</span>
<span id="cb44-83"><a href="#cb44-83" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb44-84"><a href="#cb44-84" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">FALSE</span>,</span>
<span id="cb44-85"><a href="#cb44-85" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb44-86"><a href="#cb44-86" tabindex="-1"></a>)</span>
<span id="cb44-87"><a href="#cb44-87" tabindex="-1"></a></span>
<span id="cb44-88"><a href="#cb44-88" tabindex="-1"></a><span class="do">### (2) Matrix-adjusted estimating equations and GEE</span></span>
<span id="cb44-89"><a href="#cb44-89" tabindex="-1"></a><span class="do">### on binary outcome with nested exchangeable correlation structure</span></span>
<span id="cb44-90"><a href="#cb44-90" tabindex="-1"></a></span>
<span id="cb44-91"><a href="#cb44-91" tabindex="-1"></a><span class="do">### MAEE</span></span>
<span id="cb44-92"><a href="#cb44-92" tabindex="-1"></a>est_maee_ind_bin <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb44-93"><a href="#cb44-93" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_bin,</span>
<span id="cb44-94"><a href="#cb44-94" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb44-95"><a href="#cb44-95" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb44-96"><a href="#cb44-96" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb44-97"><a href="#cb44-97" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">TRUE</span>,</span>
<span id="cb44-98"><a href="#cb44-98" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb44-99"><a href="#cb44-99" tabindex="-1"></a>)</span>
<span id="cb44-100"><a href="#cb44-100" tabindex="-1"></a></span>
<span id="cb44-101"><a href="#cb44-101" tabindex="-1"></a><span class="do">### GEE</span></span>
<span id="cb44-102"><a href="#cb44-102" tabindex="-1"></a>est_uee_ind_bin <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb44-103"><a href="#cb44-103" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_bin,</span>
<span id="cb44-104"><a href="#cb44-104" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb44-105"><a href="#cb44-105" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb44-106"><a href="#cb44-106" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb44-107"><a href="#cb44-107" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">FALSE</span>,</span>
<span id="cb44-108"><a href="#cb44-108" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb44-109"><a href="#cb44-109" tabindex="-1"></a>)</span></code></pre></div>
<p>Then we have the following output:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="co"># MAEE for continuous outcome</span></span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a><span class="fu">print</span>(est_maee_ind_con)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 7 
## Results for marginal mean parameters 
##      Beta   Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0  0.1348986 0.1291859  0.1697842  0.1826380  0.1965769  0.1798168
## [2,]    1  0.2713850 0.1746512  0.2001488  0.2195470  0.2408760  0.2172481
## [3,]    2  0.2242936 0.2143205  0.1243187  0.1373906  0.1523610  0.1347270
## [4,]    3  0.3421334 0.2696461  0.2414682  0.2634955  0.2879108  0.2629327
## [5,]    4 -0.1824207 0.2269258  0.1775156  0.1973096  0.2194501  0.1954393
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.11814099  2.1459619  2.3092102  2.4863313  2.2717905
## [2,]     1 0.04415164  0.6888222  0.7410199  0.7976414  0.7290764</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="co"># GEE for continuous outcome</span></span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a><span class="fu">print</span>(est_uee_ind_con)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 4 
## Results for marginal mean parameters 
##      Beta   Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0  0.1377223 0.1237580  0.1615739  0.1722903  0.1837689  0.1702791
## [2,]    1  0.2723025 0.1649076  0.2018461  0.2215163  0.2431605  0.2194440
## [3,]    2  0.2235232 0.2018022  0.1238738  0.1368429  0.1516911  0.1346751
## [4,]    3  0.3454827 0.2542602  0.2435906  0.2659183  0.2906703  0.2662424
## [5,]    4 -0.1829646 0.2143018  0.1784264  0.1984112  0.2207730  0.1968959
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.08866912  0.7162528  0.7860288  0.8628203  0.7786015
## [2,]     1 0.04087645  0.3630319  0.3979786  0.4364026  0.3943828</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="co"># MAEE for binary outcome</span></span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a><span class="fu">print</span>(est_maee_ind_bin)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 9 
## Results for marginal mean parameters 
##      Beta   Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0 -0.7177697 0.3243579  0.2504724  0.2626788  0.2755610  0.2670747
## [2,]    1 -0.5057164 0.3866767  0.4184022  0.4634919  0.5148205  0.4598584
## [3,]    2 -0.7507158 0.5041838  0.7566394  0.8607488  0.9814278  0.8526778
## [4,]    3 -0.4215410 0.6903277  0.6457526  0.7317282  0.8307258  0.7387263
## [5,]    4 -1.1000030 0.5788407  0.6358341  0.7220682  0.8212615  0.7152954
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.12872351 0.04214012 0.04501392 0.04811026 0.04504987
## [2,]     1 0.04998133 0.03776135 0.04003308 0.04245568 0.04005637</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="co"># GEE for binary outcome</span></span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a><span class="fu">print</span>(est_uee_ind_bin)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 5 
## Results for marginal mean parameters 
##      Beta   Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0 -0.7188014 0.3023277  0.2496582  0.2622189  0.2754855  0.2667267
## [2,]    1 -0.5039354 0.3602724  0.4176725  0.4625818  0.5137026  0.4594518
## [3,]    2 -0.7763118 0.4698037  0.7586941  0.8634678  0.9850709  0.8557903
## [4,]    3 -0.4189338 0.6440289  0.6529553  0.7396359  0.8395257  0.7474897
## [5,]    4 -1.0977160 0.5424980  0.6395300  0.7262417  0.8260927  0.7200144
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.09112146 0.03407652 0.03633943 0.03877574 0.03634703
## [2,]     1 0.04312784 0.03280064 0.03476699 0.03686398 0.03478916</code></pre>
</div>
<div id="simulated-dataset-with-12-clusters-and-large-cluster-sizes" class="section level3">
<h3>Simulated dataset with 12 clusters and large cluster sizes</h3>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="do">## let the cluster 2, 3 be with only 1 observation</span></span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a>sampleSWCRT <span class="ot">&lt;-</span> sampleSWCRTLarge[sampleSWCRTLarge<span class="sc">$</span>id <span class="sc">!=</span> <span class="dv">2</span> <span class="sc">&amp;</span> sampleSWCRTLarge<span class="sc">$</span>id <span class="sc">!=</span> <span class="dv">3</span>, ]</span>
<span id="cb53-3"><a href="#cb53-3" tabindex="-1"></a>sampleSWCRT2 <span class="ot">&lt;-</span> sampleSWCRTLarge[sampleSWCRTLarge<span class="sc">$</span>id <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> sampleSWCRTLarge<span class="sc">$</span>period <span class="sc">==</span> <span class="dv">4</span>, ][<span class="dv">1</span>, ]</span>
<span id="cb53-4"><a href="#cb53-4" tabindex="-1"></a>sampleSWCRT3 <span class="ot">&lt;-</span> sampleSWCRTLarge[sampleSWCRTLarge<span class="sc">$</span>id <span class="sc">==</span> <span class="dv">3</span> <span class="sc">&amp;</span> sampleSWCRTLarge<span class="sc">$</span>period <span class="sc">==</span> <span class="dv">5</span>, ][<span class="dv">1</span>, ]</span>
<span id="cb53-5"><a href="#cb53-5" tabindex="-1"></a>sampleSWCRT <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sampleSWCRT, sampleSWCRT2)</span>
<span id="cb53-6"><a href="#cb53-6" tabindex="-1"></a>sampleSWCRT <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sampleSWCRT, sampleSWCRT3)</span>
<span id="cb53-7"><a href="#cb53-7" tabindex="-1"></a>sampleSWCRT <span class="ot">&lt;-</span> sampleSWCRT[<span class="fu">order</span>(sampleSWCRT<span class="sc">$</span>id, sampleSWCRT<span class="sc">$</span>period), ]</span>
<span id="cb53-8"><a href="#cb53-8" tabindex="-1"></a></span>
<span id="cb53-9"><a href="#cb53-9" tabindex="-1"></a>id <span class="ot">&lt;-</span> sampleSWCRT<span class="sc">$</span>id</span>
<span id="cb53-10"><a href="#cb53-10" tabindex="-1"></a>period <span class="ot">&lt;-</span> sampleSWCRT<span class="sc">$</span>period</span>
<span id="cb53-11"><a href="#cb53-11" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(sampleSWCRT[, <span class="fu">c</span>(<span class="st">&quot;period1&quot;</span>, <span class="st">&quot;period2&quot;</span>, <span class="st">&quot;period3&quot;</span>, <span class="st">&quot;period4&quot;</span>, <span class="st">&quot;treatment&quot;</span>)])</span>
<span id="cb53-12"><a href="#cb53-12" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">table</span>(id, period))</span>
<span id="cb53-13"><a href="#cb53-13" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">dim</span>(m)[<span class="dv">1</span>]</span>
<span id="cb53-14"><a href="#cb53-14" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">dim</span>(m)[<span class="dv">2</span>]</span>
<span id="cb53-15"><a href="#cb53-15" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">createzCrossSecIgnoreOneObsCount</span>(m)</span>
<span id="cb53-16"><a href="#cb53-16" tabindex="-1"></a></span>
<span id="cb53-17"><a href="#cb53-17" tabindex="-1"></a><span class="do">### (1) Matrix-adjusted estimating equations and GEE</span></span>
<span id="cb53-18"><a href="#cb53-18" tabindex="-1"></a><span class="do">### on continous outcome with nested exchangeable correlation structure</span></span>
<span id="cb53-19"><a href="#cb53-19" tabindex="-1"></a></span>
<span id="cb53-20"><a href="#cb53-20" tabindex="-1"></a><span class="do">### MAEE</span></span>
<span id="cb53-21"><a href="#cb53-21" tabindex="-1"></a>est_maee_ind_con <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb53-22"><a href="#cb53-22" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_con,</span>
<span id="cb53-23"><a href="#cb53-23" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb53-24"><a href="#cb53-24" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;continuous&quot;</span>,</span>
<span id="cb53-25"><a href="#cb53-25" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb53-26"><a href="#cb53-26" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">TRUE</span>,</span>
<span id="cb53-27"><a href="#cb53-27" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb53-28"><a href="#cb53-28" tabindex="-1"></a>)</span>
<span id="cb53-29"><a href="#cb53-29" tabindex="-1"></a><span class="fu">print</span>(est_maee_ind_con)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 6 
## Results for marginal mean parameters 
##      Beta    Estimate  MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0  0.13025902 0.10414063 0.14548511 0.15353994 0.16204526 0.15345862
## [2,]    1  0.12125392 0.10194268 0.08757724 0.09236968 0.09743277 0.09233367
## [3,]    2 -0.01152763 0.10473717 0.07926497 0.08413526 0.08937669 0.08354342
## [4,]    3  0.05478654 0.10981242 0.08594124 0.09157935 0.09765350 0.09060846
## [5,]    4  0.12204008 0.08165944 0.06041418 0.06465424 0.06933952 0.06347192
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.07157622 0.01991177 0.02113983 0.02245462 0.02103462
## [2,]     1 0.02153243 0.01752621 0.01849796 0.01952503 0.01850074</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="do">### GEE</span></span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a>est_uee_ind_con <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb55-3"><a href="#cb55-3" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_con,</span>
<span id="cb55-4"><a href="#cb55-4" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb55-5"><a href="#cb55-5" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;continuous&quot;</span>,</span>
<span id="cb55-6"><a href="#cb55-6" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb55-7"><a href="#cb55-7" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">FALSE</span>,</span>
<span id="cb55-8"><a href="#cb55-8" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb55-9"><a href="#cb55-9" tabindex="-1"></a>)</span>
<span id="cb55-10"><a href="#cb55-10" tabindex="-1"></a><span class="fu">print</span>(est_uee_ind_con)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 5 
## Results for marginal mean parameters 
##      Beta    Estimate  MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0  0.12957321 0.09939525 0.14566793 0.15374768 0.16228061 0.15366905
## [2,]    1  0.12114456 0.09713322 0.08772912 0.09254067 0.09762440 0.09250431
## [3,]    2 -0.01223224 0.09990992 0.07909036 0.08393932 0.08915773 0.08334936
## [4,]    3  0.05415555 0.10491006 0.08545354 0.09102402 0.09702424 0.09006645
## [5,]    4  0.12265071 0.07812056 0.06039500 0.06464649 0.06934418 0.06347013
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.06145065 0.04021457 0.04271976 0.04541452 0.04241073
## [2,]     1 0.01997608 0.02157226 0.02280360 0.02411449 0.02274367</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a><span class="do">### (2) Matrix-adjusted estimating equations and GEE</span></span>
<span id="cb57-2"><a href="#cb57-2" tabindex="-1"></a><span class="do">### on binary outcome with nested exchangeable correlation structure</span></span>
<span id="cb57-3"><a href="#cb57-3" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" tabindex="-1"></a><span class="do">### MAEE</span></span>
<span id="cb57-5"><a href="#cb57-5" tabindex="-1"></a>est_maee_ind_bin <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb57-6"><a href="#cb57-6" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_bin,</span>
<span id="cb57-7"><a href="#cb57-7" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb57-8"><a href="#cb57-8" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb57-9"><a href="#cb57-9" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb57-10"><a href="#cb57-10" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">TRUE</span>,</span>
<span id="cb57-11"><a href="#cb57-11" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb57-12"><a href="#cb57-12" tabindex="-1"></a>)</span>
<span id="cb57-13"><a href="#cb57-13" tabindex="-1"></a><span class="fu">print</span>(est_maee_ind_bin)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 7 
## Results for marginal mean parameters 
##      Beta   Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0  0.1332629 0.2420923  0.2798308  0.2962875  0.3137376  0.2943275
## [2,]    1 -0.1804980 0.2392136  0.2110722  0.2241744  0.2381715  0.2225689
## [3,]    2 -0.5076878 0.2584549  0.2920199  0.3125656  0.3347155  0.3087142
## [4,]    3  0.3840753 0.2504374  0.1895220  0.2003438  0.2121205  0.1992634
## [5,]    4 -1.0262224 0.2207822  0.2506467  0.2692117  0.2893322  0.2650143
## 
## Results for correlation parameters 
##      Alpha  Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.1169820 0.04023116 0.04231185 0.04450122 0.04223456
## [2,]     1 0.0568873 0.03534790 0.03723443 0.03922241 0.03719636</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a><span class="do">### GEE</span></span>
<span id="cb59-2"><a href="#cb59-2" tabindex="-1"></a>est_uee_ind_bin <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb59-3"><a href="#cb59-3" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_bin,</span>
<span id="cb59-4"><a href="#cb59-4" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb59-5"><a href="#cb59-5" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb59-6"><a href="#cb59-6" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb59-7"><a href="#cb59-7" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">FALSE</span>,</span>
<span id="cb59-8"><a href="#cb59-8" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb59-9"><a href="#cb59-9" tabindex="-1"></a>)</span>
<span id="cb59-10"><a href="#cb59-10" tabindex="-1"></a><span class="fu">print</span>(est_uee_ind_bin)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 5 
## Results for marginal mean parameters 
##      Beta   Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0  0.1342372 0.2291780  0.2799810  0.2964751  0.3139675  0.2944929
## [2,]    1 -0.1786338 0.2261284  0.2107070  0.2237640  0.2377126  0.2221467
## [3,]    2 -0.5060056 0.2446274  0.2918120  0.3123570  0.3345099  0.3084656
## [4,]    3  0.3879678 0.2371757  0.1886817  0.1994177  0.2111038  0.1983400
## [5,]    4 -1.0247733 0.2089581  0.2503983  0.2689825  0.2891230  0.2647720
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.10039349 0.03525647 0.03708828 0.03901615 0.03702046
## [2,]     1 0.05101663 0.03088627 0.03254034 0.03428364 0.03250674</code></pre>
</div>
</div>
<div id="geemaee-examples-matrix-adjusted-gee-for-estimating-the-mean-and-correlation-parameters-in-general-crts" class="section level2">
<h2><code>geemaee()</code> examples: matrix-adjusted GEE for estimating
the mean and correlation parameters in general CRTs</h2>
<p>We can also use the <code>geemaee()</code> function for general CRTs
with only one time period. We need to specify a single column of 1’s for
the <code>Z</code> matrix.</p>
<div id="simulated-dataset-with-12-clusters-and-small-cluster-sizes-1" class="section level3">
<h3>Simulated dataset with 12 clusters and small cluster sizes</h3>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a><span class="do">### use only the second period data to get a general CRT data</span></span>
<span id="cb61-2"><a href="#cb61-2" tabindex="-1"></a>sampleSWCRT <span class="ot">&lt;-</span> sampleSWCRTSmall[sampleSWCRTSmall<span class="sc">$</span>period <span class="sc">==</span> <span class="dv">2</span>, ]</span>
<span id="cb61-3"><a href="#cb61-3" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" tabindex="-1"></a><span class="do">### Individual-level id, period, outcome, and design matrix</span></span>
<span id="cb61-5"><a href="#cb61-5" tabindex="-1"></a>id <span class="ot">&lt;-</span> sampleSWCRT<span class="sc">$</span>id</span>
<span id="cb61-6"><a href="#cb61-6" tabindex="-1"></a>period <span class="ot">&lt;-</span> sampleSWCRT<span class="sc">$</span>period</span>
<span id="cb61-7"><a href="#cb61-7" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(sampleSWCRT[, <span class="fu">c</span>(<span class="st">&quot;period2&quot;</span>, <span class="st">&quot;treatment&quot;</span>)])</span>
<span id="cb61-8"><a href="#cb61-8" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">table</span>(id, period))</span>
<span id="cb61-9"><a href="#cb61-9" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">dim</span>(m)[<span class="dv">1</span>]</span>
<span id="cb61-10"><a href="#cb61-10" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">dim</span>(m)[<span class="dv">2</span>]</span>
<span id="cb61-11"><a href="#cb61-11" tabindex="-1"></a></span>
<span id="cb61-12"><a href="#cb61-12" tabindex="-1"></a><span class="do">### design matrix for correlation parameters</span></span>
<span id="cb61-13"><a href="#cb61-13" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">createzCrossSec</span>(m)</span>
<span id="cb61-14"><a href="#cb61-14" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>, <span class="fu">dim</span>(Z)[<span class="dv">1</span>], <span class="dv">1</span>)</span>
<span id="cb61-15"><a href="#cb61-15" tabindex="-1"></a></span>
<span id="cb61-16"><a href="#cb61-16" tabindex="-1"></a><span class="do">### (1) Matrix-adjusted estimating equations and GEE</span></span>
<span id="cb61-17"><a href="#cb61-17" tabindex="-1"></a><span class="do">### on continuous outcome with nested exchangeable correlation structure</span></span>
<span id="cb61-18"><a href="#cb61-18" tabindex="-1"></a></span>
<span id="cb61-19"><a href="#cb61-19" tabindex="-1"></a><span class="do">### MAEE</span></span>
<span id="cb61-20"><a href="#cb61-20" tabindex="-1"></a>est_maee_ind_con <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb61-21"><a href="#cb61-21" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_con,</span>
<span id="cb61-22"><a href="#cb61-22" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb61-23"><a href="#cb61-23" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;continuous&quot;</span>,</span>
<span id="cb61-24"><a href="#cb61-24" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb61-25"><a href="#cb61-25" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">TRUE</span>,</span>
<span id="cb61-26"><a href="#cb61-26" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb61-27"><a href="#cb61-27" tabindex="-1"></a>)</span>
<span id="cb61-28"><a href="#cb61-28" tabindex="-1"></a></span>
<span id="cb61-29"><a href="#cb61-29" tabindex="-1"></a><span class="do">### GEE</span></span>
<span id="cb61-30"><a href="#cb61-30" tabindex="-1"></a>est_uee_ind_con <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb61-31"><a href="#cb61-31" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_con,</span>
<span id="cb61-32"><a href="#cb61-32" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb61-33"><a href="#cb61-33" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;continuous&quot;</span>,</span>
<span id="cb61-34"><a href="#cb61-34" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb61-35"><a href="#cb61-35" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">FALSE</span>,</span>
<span id="cb61-36"><a href="#cb61-36" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb61-37"><a href="#cb61-37" tabindex="-1"></a>)</span>
<span id="cb61-38"><a href="#cb61-38" tabindex="-1"></a></span>
<span id="cb61-39"><a href="#cb61-39" tabindex="-1"></a><span class="do">### (2) Matrix-adjusted estimating equations and GEE</span></span>
<span id="cb61-40"><a href="#cb61-40" tabindex="-1"></a><span class="do">### on binary outcome with nested exchangeable correlation structure</span></span>
<span id="cb61-41"><a href="#cb61-41" tabindex="-1"></a></span>
<span id="cb61-42"><a href="#cb61-42" tabindex="-1"></a><span class="do">### MAEE</span></span>
<span id="cb61-43"><a href="#cb61-43" tabindex="-1"></a>est_maee_ind_bin <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb61-44"><a href="#cb61-44" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_bin,</span>
<span id="cb61-45"><a href="#cb61-45" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb61-46"><a href="#cb61-46" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb61-47"><a href="#cb61-47" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb61-48"><a href="#cb61-48" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">TRUE</span>,</span>
<span id="cb61-49"><a href="#cb61-49" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb61-50"><a href="#cb61-50" tabindex="-1"></a>)</span>
<span id="cb61-51"><a href="#cb61-51" tabindex="-1"></a></span>
<span id="cb61-52"><a href="#cb61-52" tabindex="-1"></a><span class="do">### GEE</span></span>
<span id="cb61-53"><a href="#cb61-53" tabindex="-1"></a>est_uee_ind_bin <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb61-54"><a href="#cb61-54" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_bin,</span>
<span id="cb61-55"><a href="#cb61-55" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb61-56"><a href="#cb61-56" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb61-57"><a href="#cb61-57" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb61-58"><a href="#cb61-58" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">FALSE</span>,</span>
<span id="cb61-59"><a href="#cb61-59" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb61-60"><a href="#cb61-60" tabindex="-1"></a>)</span></code></pre></div>
<p>Then we have the following output:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a><span class="co"># MAEE for continuous outcome</span></span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a><span class="fu">print</span>(est_maee_ind_con)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 8 
## Results for marginal mean parameters 
##      Beta   Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0  0.2528124 0.1764069  0.1665441  0.1786009  0.1915347  0.1788929
## [2,]    1 -0.1552832 0.3252919  0.2292350  0.2550014  0.2844740  0.2623835
## 
## Results for correlation parameters 
##      Alpha  Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.1431597  0.1247514  0.1349427  0.1462297  0.1371536</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a><span class="co"># GEE for continuous outcome</span></span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a><span class="fu">print</span>(est_uee_ind_con)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 5 
## Results for marginal mean parameters 
##      Beta   Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0  0.2531152 0.1630992  0.1679072  0.1801949  0.1933876  0.1804643
## [2,]    1 -0.1541036 0.3048830  0.2302462  0.2561750  0.2858361  0.2632618
## 
## Results for correlation parameters 
##      Alpha  Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.1008046  0.1028606  0.1116841  0.1215172  0.1130576</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a><span class="co"># MAEE for binary outcome</span></span>
<span id="cb66-2"><a href="#cb66-2" tabindex="-1"></a><span class="fu">print</span>(est_maee_ind_bin)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 7 
## Results for marginal mean parameters 
##      Beta   Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0 -0.4629654 0.3016316  0.2796365  0.2988104  0.3193427  0.2994913
## [2,]    1 -1.3155222 0.7460472  0.7225963  0.8252954  0.9440864  0.8440973
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.04877651  0.0773374 0.08170456 0.08638036 0.08171905</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a><span class="co"># GEE for binary outcome</span></span>
<span id="cb68-2"><a href="#cb68-2" tabindex="-1"></a><span class="fu">print</span>(est_uee_ind_bin)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 4 
## Results for marginal mean parameters 
##      Beta   Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0 -0.4615411 0.2795648  0.2783017  0.2974810  0.3180402  0.2981008
## [2,]    1 -1.3237328 0.7077150  0.7244316  0.8276765  0.9471870  0.8455774
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.02148542 0.06797361 0.07165351   0.075578  0.0716616</code></pre>
</div>
<div id="simulated-dataset-with-12-clusters-and-large-cluster-sizes-1" class="section level3">
<h3>Simulated dataset with 12 clusters and large cluster sizes</h3>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a><span class="do">### use only the second period data to get a general CRT data</span></span>
<span id="cb70-2"><a href="#cb70-2" tabindex="-1"></a>sampleSWCRT <span class="ot">&lt;-</span> sampleSWCRTLarge[sampleSWCRTLarge<span class="sc">$</span>period <span class="sc">==</span> <span class="dv">2</span>, ]</span>
<span id="cb70-3"><a href="#cb70-3" tabindex="-1"></a></span>
<span id="cb70-4"><a href="#cb70-4" tabindex="-1"></a><span class="do">### Individual-level id, period, outcome, and design matrix</span></span>
<span id="cb70-5"><a href="#cb70-5" tabindex="-1"></a>id <span class="ot">&lt;-</span> sampleSWCRT<span class="sc">$</span>id</span>
<span id="cb70-6"><a href="#cb70-6" tabindex="-1"></a>period <span class="ot">&lt;-</span> sampleSWCRT<span class="sc">$</span>period</span>
<span id="cb70-7"><a href="#cb70-7" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(sampleSWCRT[, <span class="fu">c</span>(<span class="st">&quot;period2&quot;</span>, <span class="st">&quot;treatment&quot;</span>)])</span>
<span id="cb70-8"><a href="#cb70-8" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">table</span>(id, period))</span>
<span id="cb70-9"><a href="#cb70-9" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">dim</span>(m)[<span class="dv">1</span>]</span>
<span id="cb70-10"><a href="#cb70-10" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">dim</span>(m)[<span class="dv">2</span>]</span>
<span id="cb70-11"><a href="#cb70-11" tabindex="-1"></a><span class="do">### design matrix for correlation parameters</span></span>
<span id="cb70-12"><a href="#cb70-12" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">createzCrossSec</span>(m)</span>
<span id="cb70-13"><a href="#cb70-13" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>, <span class="fu">dim</span>(Z)[<span class="dv">1</span>], <span class="dv">1</span>)</span>
<span id="cb70-14"><a href="#cb70-14" tabindex="-1"></a></span>
<span id="cb70-15"><a href="#cb70-15" tabindex="-1"></a><span class="do">### (1) Matrix-adjusted estimating equations and GEE</span></span>
<span id="cb70-16"><a href="#cb70-16" tabindex="-1"></a><span class="do">### on continous outcome with nested exchangeable correlation structure</span></span>
<span id="cb70-17"><a href="#cb70-17" tabindex="-1"></a></span>
<span id="cb70-18"><a href="#cb70-18" tabindex="-1"></a><span class="do">### MAEE</span></span>
<span id="cb70-19"><a href="#cb70-19" tabindex="-1"></a>est_maee_ind_con <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb70-20"><a href="#cb70-20" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_con,</span>
<span id="cb70-21"><a href="#cb70-21" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb70-22"><a href="#cb70-22" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;continuous&quot;</span>,</span>
<span id="cb70-23"><a href="#cb70-23" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb70-24"><a href="#cb70-24" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">TRUE</span>,</span>
<span id="cb70-25"><a href="#cb70-25" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb70-26"><a href="#cb70-26" tabindex="-1"></a>)</span>
<span id="cb70-27"><a href="#cb70-27" tabindex="-1"></a><span class="fu">print</span>(est_maee_ind_con)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 12 
## Results for marginal mean parameters 
##      Beta    Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0  0.12860277 0.1447396 0.09617971  0.1020767  0.1083354  0.1048829
## [2,]    1 -0.04282951 0.2910552 0.33801997  0.4102953  0.4992432  0.4336775
## 
## Results for correlation parameters 
##      Alpha  Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.1379972 0.09222832  0.1022084  0.1135292    0.10296</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a><span class="do">### GEE</span></span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a>est_uee_ind_con <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb72-3"><a href="#cb72-3" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_con,</span>
<span id="cb72-4"><a href="#cb72-4" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb72-5"><a href="#cb72-5" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;continuous&quot;</span>,</span>
<span id="cb72-6"><a href="#cb72-6" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb72-7"><a href="#cb72-7" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">FALSE</span>,</span>
<span id="cb72-8"><a href="#cb72-8" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb72-9"><a href="#cb72-9" tabindex="-1"></a>)</span>
<span id="cb72-10"><a href="#cb72-10" tabindex="-1"></a><span class="fu">print</span>(est_uee_ind_con)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 5 
## Results for marginal mean parameters 
##      Beta    Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0  0.12846953 0.1260780 0.09652287  0.1024661  0.1087756  0.1052561
## [2,]    1 -0.04426251 0.2540746 0.33870940  0.4113183  0.5007251  0.4346729
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.09523824 0.05805399 0.06430917 0.07142729 0.06487122</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a><span class="do">### (2) Matrix-adjusted estimating equations and GEE</span></span>
<span id="cb74-2"><a href="#cb74-2" tabindex="-1"></a><span class="do">### on binary outcome with nested exchangeable correlation structure</span></span>
<span id="cb74-3"><a href="#cb74-3" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" tabindex="-1"></a><span class="do">### MAEE</span></span>
<span id="cb74-5"><a href="#cb74-5" tabindex="-1"></a>est_maee_ind_bin <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb74-6"><a href="#cb74-6" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_bin,</span>
<span id="cb74-7"><a href="#cb74-7" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb74-8"><a href="#cb74-8" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb74-9"><a href="#cb74-9" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb74-10"><a href="#cb74-10" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">TRUE</span>,</span>
<span id="cb74-11"><a href="#cb74-11" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb74-12"><a href="#cb74-12" tabindex="-1"></a>)</span>
<span id="cb74-13"><a href="#cb74-13" tabindex="-1"></a><span class="fu">print</span>(est_maee_ind_bin)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 8 
## Results for marginal mean parameters 
##      Beta  Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0 -0.334771 0.2118428  0.1862207  0.1973557  0.2091581  0.1990438
## [2,]    1 -0.875169 0.4848450  0.5284308  0.6355811  0.7671642  0.6602194
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.06293992 0.03076799 0.03204556 0.03341447 0.03206196</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a><span class="do">### GEE</span></span>
<span id="cb76-2"><a href="#cb76-2" tabindex="-1"></a>est_uee_ind_bin <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb76-3"><a href="#cb76-3" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_bin,</span>
<span id="cb76-4"><a href="#cb76-4" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb76-5"><a href="#cb76-5" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb76-6"><a href="#cb76-6" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb76-7"><a href="#cb76-7" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">FALSE</span>,</span>
<span id="cb76-8"><a href="#cb76-8" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb76-9"><a href="#cb76-9" tabindex="-1"></a>)</span>
<span id="cb76-10"><a href="#cb76-10" tabindex="-1"></a><span class="fu">print</span>(est_uee_ind_bin)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 4 
## Results for marginal mean parameters 
##      Beta   Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0 -0.3336916 0.1938905  0.1855933  0.1966610  0.2083911  0.1983170
## [2,]    1 -0.8762363 0.4449063  0.5272264  0.6338465  0.7647076  0.6582073
## 
## Results for correlation parameters 
##      Alpha  Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.0464299 0.02526121 0.02634733  0.0275056 0.02634871</code></pre>
</div>
</div>
<div id="geemaee-examples-matrix-adjusted-gee-for-estimating-the-mean-and-correlation-parameters-in-sw-crts-with-all-cluster-period-sizes-being-1" class="section level2">
<h2><code>geemaee()</code> examples: matrix-adjusted GEE for estimating
the mean and correlation parameters in SW-CRTs with all cluster-period
sizes being 1</h2>
<p>We consider an edge case when all cluster period sizes are 1, the
<code>geemaee()</code> function can still estimate the intra-period
correlation parameter.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a><span class="do">### Simulated dataset with 12 clusters and 5 periods</span></span>
<span id="cb78-2"><a href="#cb78-2" tabindex="-1"></a><span class="co"># use the first observation for each cluster-period combination</span></span>
<span id="cb78-3"><a href="#cb78-3" tabindex="-1"></a>sampleSWCRT <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb78-4"><a href="#cb78-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>) {</span>
<span id="cb78-5"><a href="#cb78-5" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb78-6"><a href="#cb78-6" tabindex="-1"></a>    row <span class="ot">&lt;-</span> sampleSWCRTLarge[sampleSWCRTLarge<span class="sc">$</span>id <span class="sc">==</span> i <span class="sc">&amp;</span></span>
<span id="cb78-7"><a href="#cb78-7" tabindex="-1"></a>      sampleSWCRTLarge<span class="sc">$</span>period <span class="sc">==</span> j, ][<span class="dv">1</span>, , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb78-8"><a href="#cb78-8" tabindex="-1"></a>    sampleSWCRT <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sampleSWCRT, row)</span>
<span id="cb78-9"><a href="#cb78-9" tabindex="-1"></a>  }</span>
<span id="cb78-10"><a href="#cb78-10" tabindex="-1"></a>}</span>
<span id="cb78-11"><a href="#cb78-11" tabindex="-1"></a></span>
<span id="cb78-12"><a href="#cb78-12" tabindex="-1"></a><span class="do">### Individual-level id, period, outcome, and design matrix</span></span>
<span id="cb78-13"><a href="#cb78-13" tabindex="-1"></a>id <span class="ot">&lt;-</span> sampleSWCRT<span class="sc">$</span>id</span>
<span id="cb78-14"><a href="#cb78-14" tabindex="-1"></a>period <span class="ot">&lt;-</span> sampleSWCRT<span class="sc">$</span>period</span>
<span id="cb78-15"><a href="#cb78-15" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(sampleSWCRT[, <span class="fu">c</span>(<span class="st">&quot;period2&quot;</span>, <span class="st">&quot;treatment&quot;</span>)])</span>
<span id="cb78-16"><a href="#cb78-16" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">table</span>(id, period))</span>
<span id="cb78-17"><a href="#cb78-17" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">dim</span>(m)[<span class="dv">1</span>]</span>
<span id="cb78-18"><a href="#cb78-18" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">dim</span>(m)[<span class="dv">2</span>]</span>
<span id="cb78-19"><a href="#cb78-19" tabindex="-1"></a><span class="do">### design matrix for correlation parameters</span></span>
<span id="cb78-20"><a href="#cb78-20" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">createzCrossSec</span>(m)</span>
<span id="cb78-21"><a href="#cb78-21" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>, <span class="fu">dim</span>(Z)[<span class="dv">1</span>], <span class="dv">1</span>)</span>
<span id="cb78-22"><a href="#cb78-22" tabindex="-1"></a></span>
<span id="cb78-23"><a href="#cb78-23" tabindex="-1"></a><span class="do">### (1) Matrix-adjusted estimating equations and GEE</span></span>
<span id="cb78-24"><a href="#cb78-24" tabindex="-1"></a><span class="do">### on continous outcome with nested exchangeable correlation structure</span></span>
<span id="cb78-25"><a href="#cb78-25" tabindex="-1"></a></span>
<span id="cb78-26"><a href="#cb78-26" tabindex="-1"></a><span class="do">### MAEE</span></span>
<span id="cb78-27"><a href="#cb78-27" tabindex="-1"></a>est_maee_ind_con <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb78-28"><a href="#cb78-28" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_con,</span>
<span id="cb78-29"><a href="#cb78-29" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb78-30"><a href="#cb78-30" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;continuous&quot;</span>,</span>
<span id="cb78-31"><a href="#cb78-31" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb78-32"><a href="#cb78-32" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">TRUE</span>,</span>
<span id="cb78-33"><a href="#cb78-33" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb78-34"><a href="#cb78-34" tabindex="-1"></a>)</span>
<span id="cb78-35"><a href="#cb78-35" tabindex="-1"></a><span class="fu">print</span>(est_maee_ind_con)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 5 
## Results for marginal mean parameters 
##      Beta   Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0  0.5226064 0.2664221  0.2943763  0.3079198  0.3221030  0.3074785
## [2,]    1 -0.1387930 0.1738662  0.1039812  0.1084762  0.1133085  0.1082068
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.03343471 0.05337304 0.05574596 0.05822439 0.05574296</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a><span class="do">### GEE</span></span>
<span id="cb80-2"><a href="#cb80-2" tabindex="-1"></a>est_uee_ind_con <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb80-3"><a href="#cb80-3" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_con,</span>
<span id="cb80-4"><a href="#cb80-4" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb80-5"><a href="#cb80-5" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;continuous&quot;</span>,</span>
<span id="cb80-6"><a href="#cb80-6" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb80-7"><a href="#cb80-7" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">FALSE</span>,</span>
<span id="cb80-8"><a href="#cb80-8" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb80-9"><a href="#cb80-9" tabindex="-1"></a>)</span>
<span id="cb80-10"><a href="#cb80-10" tabindex="-1"></a><span class="fu">print</span>(est_uee_ind_con)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 4 
## Results for marginal mean parameters 
##      Beta   Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0  0.5214368 0.2666982  0.2946670  0.3082204  0.3224140  0.3077816
## [2,]    1 -0.1374308 0.1734077  0.1040098  0.1085099  0.1133464  0.1082537
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.02928666 0.05043404 0.05267604 0.05501772 0.05267319</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a><span class="do">### (2) Matrix-adjusted estimating equations and GEE</span></span>
<span id="cb82-2"><a href="#cb82-2" tabindex="-1"></a><span class="do">### on binary outcome with nested exchangeable correlation structure</span></span>
<span id="cb82-3"><a href="#cb82-3" tabindex="-1"></a></span>
<span id="cb82-4"><a href="#cb82-4" tabindex="-1"></a><span class="do">### MAEE</span></span>
<span id="cb82-5"><a href="#cb82-5" tabindex="-1"></a>est_maee_ind_bin <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb82-6"><a href="#cb82-6" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_bin,</span>
<span id="cb82-7"><a href="#cb82-7" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb82-8"><a href="#cb82-8" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb82-9"><a href="#cb82-9" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb82-10"><a href="#cb82-10" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">TRUE</span>,</span>
<span id="cb82-11"><a href="#cb82-11" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb82-12"><a href="#cb82-12" tabindex="-1"></a>)</span>
<span id="cb82-13"><a href="#cb82-13" tabindex="-1"></a><span class="fu">print</span>(est_maee_ind_bin)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 6 
## Results for marginal mean parameters 
##      Beta  Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0 -1.264931 0.7292152  0.6558115  0.6889423  0.7239012  0.6888862
## [2,]    1 -1.030340 0.4602527  0.4253526  0.4480213  0.4719959  0.4479266
## 
## Results for correlation parameters 
##      Alpha  Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.1306334 0.08925503 0.09331933 0.09757006 0.09326206</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a><span class="do">### GEE</span></span>
<span id="cb84-2"><a href="#cb84-2" tabindex="-1"></a>est_uee_ind_bin <span class="ot">&lt;-</span> <span class="fu">geemaee</span>(</span>
<span id="cb84-3"><a href="#cb84-3" tabindex="-1"></a>  <span class="at">y =</span> sampleSWCRT<span class="sc">$</span>y_bin,</span>
<span id="cb84-4"><a href="#cb84-4" tabindex="-1"></a>  <span class="at">X =</span> X, <span class="at">id =</span> id, <span class="at">Z =</span> Z,</span>
<span id="cb84-5"><a href="#cb84-5" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb84-6"><a href="#cb84-6" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">epsilon =</span> <span class="fl">0.001</span>,</span>
<span id="cb84-7"><a href="#cb84-7" tabindex="-1"></a>  <span class="at">printrange =</span> <span class="cn">TRUE</span>, <span class="at">alpadj =</span> <span class="cn">FALSE</span>,</span>
<span id="cb84-8"><a href="#cb84-8" tabindex="-1"></a>  <span class="at">shrink =</span> <span class="st">&quot;ALPHA&quot;</span>, <span class="at">makevone =</span> <span class="cn">FALSE</span></span>
<span id="cb84-9"><a href="#cb84-9" tabindex="-1"></a>)</span>
<span id="cb84-10"><a href="#cb84-10" tabindex="-1"></a><span class="fu">print</span>(est_uee_ind_bin)</span></code></pre></div>
<pre><code>## GEE for correlated data 
##  Number of Iterations: 6 
## Results for marginal mean parameters 
##      Beta  Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0 -1.273321 0.7333238  0.6616293  0.6950886  0.7303935  0.6950624
## [2,]    1 -1.034997 0.4593608  0.4262109  0.4490046  0.4731156  0.4489339
## 
## Results for correlation parameters 
##      Alpha  Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.1206901 0.08954629 0.09361527 0.09787038 0.09356217</code></pre>
</div>
<div id="cpgeeswd-examples-cluster-period-gee-for-estimating-the-marginal-mean-and-correlation-parameters-in-cross-sectional-sw-crts" class="section level2">
<h2><code>cpgeeSWD()</code> examples: cluster-period GEE for estimating
the marginal mean and correlation parameters in cross-sectional
SW-CRTs</h2>
<p>The <code>cpgeeSWD()</code> function implements the cluster-period
GEE developed for cross-sectional stepped wedge cluster randomized
trials (SW-CRTs). It provides valid estimation and inference for the
treatment effect and intraclass correlation parameters within the GEE
framework, and is computationally efficient for analyzing SW-CRTs with
large cluster sizes. The program currently only allows for a marginal
mean model with discrete period effects and the intervention indicator
without additional covariates. The program offers bias-corrected ICC
estimates as well as bias-corrected sandwich variances for both the
treatment effect parameter and the ICC parameters. The technical details
of the cluster-period GEE approach are provided in <span class="citation">(Li et al. 2022)</span>.</p>
<div id="simulated-dataset-with-12-clusters-and-4-periods-1" class="section level3">
<h3>Simulated dataset with 12 clusters and 4 periods</h3>
<p>We summarize the individual-level simulated SW-CRT data to
cluster-period data and use the <code>cpgeeSWD()</code> function to
estimate the marginal mean and correlation parameters on cluster-period
means of binary outcome. We first transform the variables to get the
cluster-period mean outcome <code>y_cp</code>, mean parameters’ design
matrix <code>X_cp</code> as well as other arguments.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a><span class="do">########################################################################</span></span>
<span id="cb86-2"><a href="#cb86-2" tabindex="-1"></a><span class="do">### Example 1): simulated SW-CRT with smaller cluster-period sizes (5~10)</span></span>
<span id="cb86-3"><a href="#cb86-3" tabindex="-1"></a><span class="do">########################################################################</span></span>
<span id="cb86-4"><a href="#cb86-4" tabindex="-1"></a></span>
<span id="cb86-5"><a href="#cb86-5" tabindex="-1"></a>sampleSWCRT <span class="ot">&lt;-</span> sampleSWCRTSmall</span>
<span id="cb86-6"><a href="#cb86-6" tabindex="-1"></a></span>
<span id="cb86-7"><a href="#cb86-7" tabindex="-1"></a><span class="do">### cluster-period id, period, outcome, and design matrix</span></span>
<span id="cb86-8"><a href="#cb86-8" tabindex="-1"></a><span class="do">### id, period, outcome</span></span>
<span id="cb86-9"><a href="#cb86-9" tabindex="-1"></a>id <span class="ot">&lt;-</span> sampleSWCRT<span class="sc">$</span>id</span>
<span id="cb86-10"><a href="#cb86-10" tabindex="-1"></a>period <span class="ot">&lt;-</span> sampleSWCRT<span class="sc">$</span>period</span>
<span id="cb86-11"><a href="#cb86-11" tabindex="-1"></a>y <span class="ot">&lt;-</span> sampleSWCRT<span class="sc">$</span>y_bin</span>
<span id="cb86-12"><a href="#cb86-12" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(sampleSWCRT[, <span class="fu">c</span>(<span class="st">&quot;period1&quot;</span>, <span class="st">&quot;period2&quot;</span>, <span class="st">&quot;period3&quot;</span>, <span class="st">&quot;period4&quot;</span>, <span class="st">&quot;treatment&quot;</span>)])</span>
<span id="cb86-13"><a href="#cb86-13" tabindex="-1"></a></span>
<span id="cb86-14"><a href="#cb86-14" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">table</span>(id, period))</span>
<span id="cb86-15"><a href="#cb86-15" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">dim</span>(m)[<span class="dv">1</span>]</span>
<span id="cb86-16"><a href="#cb86-16" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">dim</span>(m)[<span class="dv">2</span>]</span>
<span id="cb86-17"><a href="#cb86-17" tabindex="-1"></a>clp_mu <span class="ot">&lt;-</span> <span class="fu">tapply</span>(y, <span class="fu">list</span>(id, period), <span class="at">FUN =</span> mean)</span>
<span id="cb86-18"><a href="#cb86-18" tabindex="-1"></a>y_cp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">t</span>(clp_mu))</span>
<span id="cb86-19"><a href="#cb86-19" tabindex="-1"></a></span>
<span id="cb86-20"><a href="#cb86-20" tabindex="-1"></a><span class="do">### design matrix for correlation parameters</span></span>
<span id="cb86-21"><a href="#cb86-21" tabindex="-1"></a>trt <span class="ot">&lt;-</span> <span class="fu">tapply</span>(X[, t <span class="sc">+</span> <span class="dv">1</span>], <span class="fu">list</span>(id, period), <span class="at">FUN =</span> mean)</span>
<span id="cb86-22"><a href="#cb86-22" tabindex="-1"></a>trt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">t</span>(trt))</span>
<span id="cb86-23"><a href="#cb86-23" tabindex="-1"></a></span>
<span id="cb86-24"><a href="#cb86-24" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="fu">tapply</span>(period, <span class="fu">list</span>(id, period), <span class="at">FUN =</span> mean)</span>
<span id="cb86-25"><a href="#cb86-25" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">t</span>(time))</span>
<span id="cb86-26"><a href="#cb86-26" tabindex="-1"></a>X_cp <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, n <span class="sc">*</span> t, t)</span>
<span id="cb86-27"><a href="#cb86-27" tabindex="-1"></a></span>
<span id="cb86-28"><a href="#cb86-28" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb86-29"><a href="#cb86-29" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb86-30"><a href="#cb86-30" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>t) {</span>
<span id="cb86-31"><a href="#cb86-31" tabindex="-1"></a>    X_cp[s, time[s]] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb86-32"><a href="#cb86-32" tabindex="-1"></a>    s <span class="ot">&lt;-</span> s <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb86-33"><a href="#cb86-33" tabindex="-1"></a>  }</span>
<span id="cb86-34"><a href="#cb86-34" tabindex="-1"></a>}</span>
<span id="cb86-35"><a href="#cb86-35" tabindex="-1"></a>X_cp <span class="ot">&lt;-</span> <span class="fu">cbind</span>(X_cp, trt)</span>
<span id="cb86-36"><a href="#cb86-36" tabindex="-1"></a>id_cp <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">each =</span> t)</span>
<span id="cb86-37"><a href="#cb86-37" tabindex="-1"></a>m_cp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">t</span>(m))</span></code></pre></div>
<p>We implement the <code>cpgeeSWD()</code> function on all the three
choices of the correlation structure including
<code>&quot;exchangeable&quot;</code>, <code>&quot;nest_exch&quot;</code> and
<code>&quot;exp_decay&quot;</code>. We consider both matrix-adjusted estimating
equations (MAEE) with <code>alpadj = TRUE</code> and uncorrected
generalized estimating equations (GEE) with
<code>alpadj = FALSE</code>.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a><span class="do">### cluster-period matrix-adjusted estimating equations (MAEE)</span></span>
<span id="cb87-2"><a href="#cb87-2" tabindex="-1"></a><span class="do">### with exchangeable, nested exchangeable and exponential decay correlation structures</span></span>
<span id="cb87-3"><a href="#cb87-3" tabindex="-1"></a><span class="co"># exponential</span></span>
<span id="cb87-4"><a href="#cb87-4" tabindex="-1"></a>est_maee_exc <span class="ot">&lt;-</span> <span class="fu">cpgeeSWD</span>(</span>
<span id="cb87-5"><a href="#cb87-5" tabindex="-1"></a>  <span class="at">y =</span> y_cp, <span class="at">X =</span> X_cp, <span class="at">id =</span> id_cp,</span>
<span id="cb87-6"><a href="#cb87-6" tabindex="-1"></a>  <span class="at">m =</span> m_cp, <span class="at">corstr =</span> <span class="st">&quot;exchangeable&quot;</span>,</span>
<span id="cb87-7"><a href="#cb87-7" tabindex="-1"></a>  <span class="at">alpadj =</span> <span class="cn">TRUE</span></span>
<span id="cb87-8"><a href="#cb87-8" tabindex="-1"></a>)</span>
<span id="cb87-9"><a href="#cb87-9" tabindex="-1"></a><span class="fu">print</span>(est_maee_exc)</span></code></pre></div>
<pre><code>## GEE and MAEE for Cluster-Period Summaries 
##  Number of Iterations: 4 
## Results for marginal mean parameters 
##      Beta   Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0 -0.7678066 0.2703014  0.2394340  0.2506194  0.2623375  0.2575649
## [2,]    1 -0.4899672 0.2929374  0.3175202  0.3415573  0.3679292  0.3465760
## [3,]    2 -0.6692544 0.3719364  0.5582006  0.6161580  0.6810928  0.6184389
## [4,]    3 -0.5967261 0.5257133  0.5630605  0.6178896  0.6788478  0.6378908
## [5,]    4 -0.9712041 0.4316492  0.5346929  0.5883089  0.6479608  0.5905832
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.07171243 0.03869076 0.04059179  0.0425914 0.04058122</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a><span class="co"># nested exchangeable</span></span>
<span id="cb89-2"><a href="#cb89-2" tabindex="-1"></a>est_maee_nex <span class="ot">&lt;-</span> <span class="fu">cpgeeSWD</span>(</span>
<span id="cb89-3"><a href="#cb89-3" tabindex="-1"></a>  <span class="at">y =</span> y_cp, <span class="at">X =</span> X_cp, <span class="at">id =</span> id_cp,</span>
<span id="cb89-4"><a href="#cb89-4" tabindex="-1"></a>  <span class="at">m =</span> m_cp, <span class="at">corstr =</span> <span class="st">&quot;nest_exch&quot;</span>,</span>
<span id="cb89-5"><a href="#cb89-5" tabindex="-1"></a>  <span class="at">alpadj =</span> <span class="cn">TRUE</span></span>
<span id="cb89-6"><a href="#cb89-6" tabindex="-1"></a>)</span>
<span id="cb89-7"><a href="#cb89-7" tabindex="-1"></a><span class="fu">print</span>(est_maee_nex)</span></code></pre></div>
<pre><code>## GEE and MAEE for Cluster-Period Summaries 
##  Number of Iterations: 6 
## Results for marginal mean parameters 
##      Beta   Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0 -0.7721492 0.2931061  0.2388699  0.2498629  0.2613680  0.2533655
## [2,]    1 -0.5036505 0.3216055  0.3154306  0.3394624  0.3658386  0.3392457
## [3,]    2 -0.6217770 0.4152335  0.5684728  0.6271700  0.6927849  0.6233328
## [4,]    3 -0.5994803 0.5967744  0.5467135  0.6003143  0.6598640  0.6091679
## [5,]    4 -0.9861662 0.4905999  0.5305528  0.5839117  0.6431778  0.5821589
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.10820010 0.04714541 0.04951304 0.05200312 0.04952131
## [2,]     1 0.05385588 0.03727153 0.03907559 0.04097119 0.03907206</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a><span class="co"># exponential decay</span></span>
<span id="cb91-2"><a href="#cb91-2" tabindex="-1"></a>est_maee_ed <span class="ot">&lt;-</span> <span class="fu">cpgeeSWD</span>(</span>
<span id="cb91-3"><a href="#cb91-3" tabindex="-1"></a>  <span class="at">y =</span> y_cp, <span class="at">X =</span> X_cp, <span class="at">id =</span> id_cp,</span>
<span id="cb91-4"><a href="#cb91-4" tabindex="-1"></a>  <span class="at">m =</span> m_cp, <span class="at">corstr =</span> <span class="st">&quot;exp_decay&quot;</span>,</span>
<span id="cb91-5"><a href="#cb91-5" tabindex="-1"></a>  <span class="at">alpadj =</span> <span class="cn">TRUE</span></span>
<span id="cb91-6"><a href="#cb91-6" tabindex="-1"></a>)</span>
<span id="cb91-7"><a href="#cb91-7" tabindex="-1"></a><span class="fu">print</span>(est_maee_ed)</span></code></pre></div>
<pre><code>## GEE and MAEE for Cluster-Period Summaries 
##  Number of Iterations: 7 
## Results for marginal mean parameters 
##      Beta   Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0 -0.7710180 0.2950154  0.2375293  0.2483319  0.2596306  0.2513006
## [2,]    1 -0.4988642 0.3224197  0.3145635  0.3388380  0.3654862  0.3397012
## [3,]    2 -0.6284311 0.4156078  0.5720337  0.6309674  0.6968561  0.6305171
## [4,]    3 -0.6140801 0.5986182  0.5461283  0.5997932  0.6594254  0.6124552
## [5,]    4 -0.9866725 0.4904297  0.5309814  0.5843712  0.6436174  0.5841529
## 
## Results for correlation parameters 
##      Alpha  Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.1115235  0.0471122 0.04949153 0.05199521 0.04946812
## [2,]     1 0.6158576  0.1759633 0.18398863 0.19240603 0.18381541</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a><span class="do">### cluster-period GEE</span></span>
<span id="cb93-2"><a href="#cb93-2" tabindex="-1"></a><span class="do">### with exchangeable, nested exchangeable and exponential decay correlation structures</span></span>
<span id="cb93-3"><a href="#cb93-3" tabindex="-1"></a></span>
<span id="cb93-4"><a href="#cb93-4" tabindex="-1"></a><span class="co"># exchangeable</span></span>
<span id="cb93-5"><a href="#cb93-5" tabindex="-1"></a>est_uee_exc <span class="ot">&lt;-</span> <span class="fu">cpgeeSWD</span>(</span>
<span id="cb93-6"><a href="#cb93-6" tabindex="-1"></a>  <span class="at">y =</span> y_cp, <span class="at">X =</span> X_cp, <span class="at">id =</span> id_cp,</span>
<span id="cb93-7"><a href="#cb93-7" tabindex="-1"></a>  <span class="at">m =</span> m_cp, <span class="at">corstr =</span> <span class="st">&quot;exchangeable&quot;</span>,</span>
<span id="cb93-8"><a href="#cb93-8" tabindex="-1"></a>  <span class="at">alpadj =</span> <span class="cn">FALSE</span></span>
<span id="cb93-9"><a href="#cb93-9" tabindex="-1"></a>)</span>
<span id="cb93-10"><a href="#cb93-10" tabindex="-1"></a><span class="fu">print</span>(est_uee_exc)</span></code></pre></div>
<pre><code>## GEE and MAEE for Cluster-Period Summaries 
##  Number of Iterations: 4 
## Results for marginal mean parameters 
##      Beta   Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0 -0.7679011 0.2611220  0.2398530  0.2510783  0.2628390  0.2564986
## [2,]    1 -0.4911553 0.2852177  0.3154908  0.3393963  0.3656321  0.3424027
## [3,]    2 -0.6697603 0.3647602  0.5627720  0.6215708  0.6874968  0.6213395
## [4,]    3 -0.5940272 0.5205574  0.5631388  0.6182225  0.6795178  0.6340687
## [5,]    4 -0.9751028 0.4299957  0.5367262  0.5907718  0.6509467  0.5916886
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.05725857 0.03375491 0.03539291 0.03711574 0.03538186</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a><span class="co"># nested exchangeable</span></span>
<span id="cb95-2"><a href="#cb95-2" tabindex="-1"></a>est_uee_nex <span class="ot">&lt;-</span> <span class="fu">cpgeeSWD</span>(</span>
<span id="cb95-3"><a href="#cb95-3" tabindex="-1"></a>  <span class="at">y =</span> y_cp, <span class="at">X =</span> X_cp, <span class="at">id =</span> id_cp,</span>
<span id="cb95-4"><a href="#cb95-4" tabindex="-1"></a>  <span class="at">m =</span> m_cp, <span class="at">corstr =</span> <span class="st">&quot;nest_exch&quot;</span>,</span>
<span id="cb95-5"><a href="#cb95-5" tabindex="-1"></a>  <span class="at">alpadj =</span> <span class="cn">FALSE</span></span>
<span id="cb95-6"><a href="#cb95-6" tabindex="-1"></a>)</span>
<span id="cb95-7"><a href="#cb95-7" tabindex="-1"></a><span class="fu">print</span>(est_uee_nex)</span></code></pre></div>
<pre><code>## GEE and MAEE for Cluster-Period Summaries 
##  Number of Iterations: 4 
## Results for marginal mean parameters 
##      Beta   Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0 -0.7701899 0.2728928  0.2396011  0.2507209  0.2623647  0.2544085
## [2,]    1 -0.4993131 0.2999219  0.3142455  0.3381255  0.3643392  0.3384140
## [3,]    2 -0.6424236 0.3867725  0.5686219  0.6278135  0.6940831  0.6244480
## [4,]    3 -0.5956930 0.5566382  0.5540211  0.6083847  0.6688445  0.6182629
## [5,]    4 -0.9836857 0.4595437  0.5345098  0.5883958  0.6483261  0.5870942
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.07500427 0.03992967 0.04189842 0.04396787 0.04190479
## [2,]     1 0.04814669 0.03293754 0.03450776 0.03615783 0.03449733</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" tabindex="-1"></a><span class="co"># exponential decay</span></span>
<span id="cb97-2"><a href="#cb97-2" tabindex="-1"></a>est_uee_ed <span class="ot">&lt;-</span> <span class="fu">cpgeeSWD</span>(</span>
<span id="cb97-3"><a href="#cb97-3" tabindex="-1"></a>  <span class="at">y =</span> y_cp, <span class="at">X =</span> X_cp, <span class="at">id =</span> id_cp,</span>
<span id="cb97-4"><a href="#cb97-4" tabindex="-1"></a>  <span class="at">m =</span> m_cp, <span class="at">corstr =</span> <span class="st">&quot;exp_decay&quot;</span>,</span>
<span id="cb97-5"><a href="#cb97-5" tabindex="-1"></a>  <span class="at">alpadj =</span> <span class="cn">FALSE</span></span>
<span id="cb97-6"><a href="#cb97-6" tabindex="-1"></a>)</span>
<span id="cb97-7"><a href="#cb97-7" tabindex="-1"></a><span class="fu">print</span>(est_uee_ed)</span></code></pre></div>
<pre><code>## GEE and MAEE for Cluster-Period Summaries 
##  Number of Iterations: 4 
## Results for marginal mean parameters 
##      Beta   Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0 -0.7691313 0.2760920  0.2385661  0.2495298  0.2610036  0.2526378
## [2,]    1 -0.4960302 0.3027753  0.3135021  0.3375362  0.3639236  0.3382822
## [3,]    2 -0.6436889 0.3904936  0.5720324  0.6315468  0.6981797  0.6302718
## [4,]    3 -0.6064791 0.5635697  0.5533253  0.6077753  0.6683419  0.6196995
## [5,]    4 -0.9866876 0.4640753  0.5348939  0.5888701  0.6488594  0.5884695
## 
## Results for correlation parameters 
##      Alpha  Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.0800789 0.04026846 0.04227077 0.04437711 0.04228027
## [2,]     1 0.7046177 0.17583729 0.18376072 0.19206554 0.18353049</code></pre>
</div>
<div id="simulated-dataset-with-12-clusters-and-5-periods-1" class="section level3">
<h3>Simulated dataset with 12 clusters and 5 periods</h3>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a><span class="do">########################################################################</span></span>
<span id="cb99-2"><a href="#cb99-2" tabindex="-1"></a><span class="do">### Example 2): simulated SW-CRT with larger cluster-period sizes (20~30)</span></span>
<span id="cb99-3"><a href="#cb99-3" tabindex="-1"></a><span class="do">########################################################################</span></span>
<span id="cb99-4"><a href="#cb99-4" tabindex="-1"></a></span>
<span id="cb99-5"><a href="#cb99-5" tabindex="-1"></a>sampleSWCRT <span class="ot">&lt;-</span> sampleSWCRTLarge</span>
<span id="cb99-6"><a href="#cb99-6" tabindex="-1"></a></span>
<span id="cb99-7"><a href="#cb99-7" tabindex="-1"></a><span class="do">### cluster-period id, period, outcome, and design matrix</span></span>
<span id="cb99-8"><a href="#cb99-8" tabindex="-1"></a><span class="do">### id, period, outcome</span></span>
<span id="cb99-9"><a href="#cb99-9" tabindex="-1"></a>id <span class="ot">&lt;-</span> sampleSWCRT<span class="sc">$</span>id</span>
<span id="cb99-10"><a href="#cb99-10" tabindex="-1"></a>period <span class="ot">&lt;-</span> sampleSWCRT<span class="sc">$</span>period</span>
<span id="cb99-11"><a href="#cb99-11" tabindex="-1"></a>y <span class="ot">&lt;-</span> sampleSWCRT<span class="sc">$</span>y_bin</span>
<span id="cb99-12"><a href="#cb99-12" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(sampleSWCRT[, <span class="fu">c</span>(<span class="st">&quot;period1&quot;</span>, <span class="st">&quot;period2&quot;</span>, <span class="st">&quot;period3&quot;</span>, <span class="st">&quot;period4&quot;</span>, <span class="st">&quot;period5&quot;</span>, <span class="st">&quot;treatment&quot;</span>)])</span>
<span id="cb99-13"><a href="#cb99-13" tabindex="-1"></a></span>
<span id="cb99-14"><a href="#cb99-14" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">table</span>(id, period))</span>
<span id="cb99-15"><a href="#cb99-15" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">dim</span>(m)[<span class="dv">1</span>]</span>
<span id="cb99-16"><a href="#cb99-16" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">dim</span>(m)[<span class="dv">2</span>]</span>
<span id="cb99-17"><a href="#cb99-17" tabindex="-1"></a>clp_mu <span class="ot">&lt;-</span> <span class="fu">tapply</span>(y, <span class="fu">list</span>(id, period), <span class="at">FUN =</span> mean)</span>
<span id="cb99-18"><a href="#cb99-18" tabindex="-1"></a>y_cp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">t</span>(clp_mu))</span>
<span id="cb99-19"><a href="#cb99-19" tabindex="-1"></a></span>
<span id="cb99-20"><a href="#cb99-20" tabindex="-1"></a><span class="do">### design matrix for correlation parameters</span></span>
<span id="cb99-21"><a href="#cb99-21" tabindex="-1"></a>trt <span class="ot">&lt;-</span> <span class="fu">tapply</span>(X[, t <span class="sc">+</span> <span class="dv">1</span>], <span class="fu">list</span>(id, period), <span class="at">FUN =</span> mean)</span>
<span id="cb99-22"><a href="#cb99-22" tabindex="-1"></a>trt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">t</span>(trt))</span>
<span id="cb99-23"><a href="#cb99-23" tabindex="-1"></a></span>
<span id="cb99-24"><a href="#cb99-24" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="fu">tapply</span>(period, <span class="fu">list</span>(id, period), <span class="at">FUN =</span> mean)</span>
<span id="cb99-25"><a href="#cb99-25" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">t</span>(time))</span>
<span id="cb99-26"><a href="#cb99-26" tabindex="-1"></a>X_cp <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, n <span class="sc">*</span> t, t)</span>
<span id="cb99-27"><a href="#cb99-27" tabindex="-1"></a></span>
<span id="cb99-28"><a href="#cb99-28" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb99-29"><a href="#cb99-29" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb99-30"><a href="#cb99-30" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>t) {</span>
<span id="cb99-31"><a href="#cb99-31" tabindex="-1"></a>    X_cp[s, time[s]] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb99-32"><a href="#cb99-32" tabindex="-1"></a>    s <span class="ot">&lt;-</span> s <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb99-33"><a href="#cb99-33" tabindex="-1"></a>  }</span>
<span id="cb99-34"><a href="#cb99-34" tabindex="-1"></a>}</span>
<span id="cb99-35"><a href="#cb99-35" tabindex="-1"></a>X_cp <span class="ot">&lt;-</span> <span class="fu">cbind</span>(X_cp, trt)</span>
<span id="cb99-36"><a href="#cb99-36" tabindex="-1"></a>id_cp <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">each =</span> t)</span>
<span id="cb99-37"><a href="#cb99-37" tabindex="-1"></a>m_cp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">t</span>(m))</span>
<span id="cb99-38"><a href="#cb99-38" tabindex="-1"></a></span>
<span id="cb99-39"><a href="#cb99-39" tabindex="-1"></a><span class="do">### cluster-period matrix-adjusted estimating equations (MAEE)</span></span>
<span id="cb99-40"><a href="#cb99-40" tabindex="-1"></a><span class="do">### with exchangeable, nested exchangeable and exponential decay correlation structures</span></span>
<span id="cb99-41"><a href="#cb99-41" tabindex="-1"></a><span class="co"># exponential</span></span>
<span id="cb99-42"><a href="#cb99-42" tabindex="-1"></a>est_maee_exc <span class="ot">&lt;-</span> <span class="fu">cpgeeSWD</span>(</span>
<span id="cb99-43"><a href="#cb99-43" tabindex="-1"></a>  <span class="at">y =</span> y_cp, <span class="at">X =</span> X_cp, <span class="at">id =</span> id_cp,</span>
<span id="cb99-44"><a href="#cb99-44" tabindex="-1"></a>  <span class="at">m =</span> m_cp, <span class="at">corstr =</span> <span class="st">&quot;exchangeable&quot;</span>,</span>
<span id="cb99-45"><a href="#cb99-45" tabindex="-1"></a>  <span class="at">alpadj =</span> <span class="cn">TRUE</span></span>
<span id="cb99-46"><a href="#cb99-46" tabindex="-1"></a>)</span>
<span id="cb99-47"><a href="#cb99-47" tabindex="-1"></a><span class="fu">print</span>(est_maee_exc)</span></code></pre></div>
<pre><code>## GEE and MAEE for Cluster-Period Summaries 
##  Number of Iterations: 4 
## Results for marginal mean parameters 
##      Beta    Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0 -0.03937150 0.1955148  0.2373442  0.2480663  0.2592915  0.2392651
## [2,]    1 -0.33407908 0.2022096  0.2200174  0.2352782  0.2517452  0.2396738
## [3,]    2 -0.67338220 0.2343484  0.2944134  0.3178251  0.3435471  0.3183472
## [4,]    3  0.04608714 0.2414272  0.2332480  0.2536047  0.2774156  0.2480103
## [5,]    4 -0.43352358 0.2901120  0.1710562  0.1877125  0.2079820  0.1965489
## [6,]    5 -0.82493433 0.1977208  0.2758767  0.3031771  0.3333531  0.3000391
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.07782417 0.03688003 0.03829676 0.03976975 0.03827983</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" tabindex="-1"></a><span class="co"># nested exchangeable</span></span>
<span id="cb101-2"><a href="#cb101-2" tabindex="-1"></a>est_maee_nex <span class="ot">&lt;-</span> <span class="fu">cpgeeSWD</span>(</span>
<span id="cb101-3"><a href="#cb101-3" tabindex="-1"></a>  <span class="at">y =</span> y_cp, <span class="at">X =</span> X_cp, <span class="at">id =</span> id_cp,</span>
<span id="cb101-4"><a href="#cb101-4" tabindex="-1"></a>  <span class="at">m =</span> m_cp, <span class="at">corstr =</span> <span class="st">&quot;nest_exch&quot;</span>,</span>
<span id="cb101-5"><a href="#cb101-5" tabindex="-1"></a>  <span class="at">alpadj =</span> <span class="cn">TRUE</span></span>
<span id="cb101-6"><a href="#cb101-6" tabindex="-1"></a>)</span>
<span id="cb101-7"><a href="#cb101-7" tabindex="-1"></a><span class="fu">print</span>(est_maee_nex)</span></code></pre></div>
<pre><code>## GEE and MAEE for Cluster-Period Summaries 
##  Number of Iterations: 4 
## Results for marginal mean parameters 
##      Beta    Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0 -0.03432555 0.2278441  0.2393377  0.2499941  0.2611267  0.2479004
## [2,]    1 -0.34293068 0.2424034  0.2082967  0.2231294  0.2391131  0.2212194
## [3,]    2 -0.67730319 0.2887517  0.2713904  0.2930314  0.3167289  0.2876482
## [4,]    3  0.02825126 0.3212402  0.1938752  0.2119627  0.2334399  0.2046802
## [5,]    4 -0.42990720 0.3990553  0.1849263  0.2025603  0.2234539  0.2035330
## [6,]    5 -0.81687942 0.3038572  0.2835181  0.3107636  0.3407871  0.3069380
## 
## Results for correlation parameters 
##      Alpha  Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.1201529 0.04650374 0.04831496 0.05019968 0.04830353
## [2,]     1 0.0584004 0.03424640 0.03557674 0.03696081 0.03558240</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" tabindex="-1"></a><span class="co"># exponential decay</span></span>
<span id="cb103-2"><a href="#cb103-2" tabindex="-1"></a>est_maee_ed <span class="ot">&lt;-</span> <span class="fu">cpgeeSWD</span>(</span>
<span id="cb103-3"><a href="#cb103-3" tabindex="-1"></a>  <span class="at">y =</span> y_cp, <span class="at">X =</span> X_cp, <span class="at">id =</span> id_cp,</span>
<span id="cb103-4"><a href="#cb103-4" tabindex="-1"></a>  <span class="at">m =</span> m_cp, <span class="at">corstr =</span> <span class="st">&quot;exp_decay&quot;</span>,</span>
<span id="cb103-5"><a href="#cb103-5" tabindex="-1"></a>  <span class="at">alpadj =</span> <span class="cn">TRUE</span></span>
<span id="cb103-6"><a href="#cb103-6" tabindex="-1"></a>)</span>
<span id="cb103-7"><a href="#cb103-7" tabindex="-1"></a><span class="fu">print</span>(est_maee_ed)</span></code></pre></div>
<pre><code>## GEE and MAEE for Cluster-Period Summaries 
##  Number of Iterations: 7 
## Results for marginal mean parameters 
##      Beta    Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0 -0.03340439 0.2236591  0.2415963  0.2524580  0.2638106  0.2513261
## [2,]    1 -0.32963269 0.2361087  0.2096366  0.2232709  0.2378969  0.2223343
## [3,]    2 -0.66086972 0.2793325  0.2679038  0.2864419  0.3065960  0.2820858
## [4,]    3  0.05215247 0.3068537  0.2126799  0.2276517  0.2447418  0.2231794
## [5,]    4 -0.38679195 0.3815072  0.1392210  0.1482120  0.1597143  0.1537140
## [6,]    5 -0.85944259 0.2843752  0.2312996  0.2529042  0.2766009  0.2467741
## 
## Results for correlation parameters 
##      Alpha  Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.1143454 0.04222592 0.04384679 0.04553347 0.04380728
## [2,]     1 0.7000112 0.14390913 0.15014145 0.15665442 0.15034373</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" tabindex="-1"></a><span class="do">### cluster-period GEE</span></span>
<span id="cb105-2"><a href="#cb105-2" tabindex="-1"></a><span class="do">### with exchangeable, nested exchangeable and exponential decay correlation structures</span></span>
<span id="cb105-3"><a href="#cb105-3" tabindex="-1"></a></span>
<span id="cb105-4"><a href="#cb105-4" tabindex="-1"></a><span class="co"># exchangeable</span></span>
<span id="cb105-5"><a href="#cb105-5" tabindex="-1"></a>est_uee_exc <span class="ot">&lt;-</span> <span class="fu">cpgeeSWD</span>(</span>
<span id="cb105-6"><a href="#cb105-6" tabindex="-1"></a>  <span class="at">y =</span> y_cp, <span class="at">X =</span> X_cp, <span class="at">id =</span> id_cp,</span>
<span id="cb105-7"><a href="#cb105-7" tabindex="-1"></a>  <span class="at">m =</span> m_cp, <span class="at">corstr =</span> <span class="st">&quot;exchangeable&quot;</span>,</span>
<span id="cb105-8"><a href="#cb105-8" tabindex="-1"></a>  <span class="at">alpadj =</span> <span class="cn">FALSE</span></span>
<span id="cb105-9"><a href="#cb105-9" tabindex="-1"></a>)</span>
<span id="cb105-10"><a href="#cb105-10" tabindex="-1"></a><span class="fu">print</span>(est_uee_exc)</span></code></pre></div>
<pre><code>## GEE and MAEE for Cluster-Period Summaries 
##  Number of Iterations: 3 
## Results for marginal mean parameters 
##      Beta    Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0 -0.03987191 0.1891780  0.2375607  0.2482853  0.2595112  0.2404060
## [2,]    1 -0.33454114 0.1959210  0.2189623  0.2341927  0.2506256  0.2376880
## [3,]    2 -0.67375572 0.2281604  0.2923708  0.3156737  0.3412787  0.3152896
## [4,]    3  0.04529970 0.2371119  0.2301168  0.2503246  0.2740128  0.2444258
## [5,]    4 -0.43427752 0.2857409  0.1708179  0.1874729  0.2077462  0.1952451
## [6,]    5 -0.82467526 0.1978609  0.2760276  0.3033256  0.3334993  0.3001943
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.07013385 0.03368912 0.03498342 0.03632918 0.03496968</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" tabindex="-1"></a><span class="co"># nested exchangeable</span></span>
<span id="cb107-2"><a href="#cb107-2" tabindex="-1"></a>est_uee_nex <span class="ot">&lt;-</span> <span class="fu">cpgeeSWD</span>(</span>
<span id="cb107-3"><a href="#cb107-3" tabindex="-1"></a>  <span class="at">y =</span> y_cp, <span class="at">X =</span> X_cp, <span class="at">id =</span> id_cp,</span>
<span id="cb107-4"><a href="#cb107-4" tabindex="-1"></a>  <span class="at">m =</span> m_cp, <span class="at">corstr =</span> <span class="st">&quot;nest_exch&quot;</span>,</span>
<span id="cb107-5"><a href="#cb107-5" tabindex="-1"></a>  <span class="at">alpadj =</span> <span class="cn">FALSE</span></span>
<span id="cb107-6"><a href="#cb107-6" tabindex="-1"></a>)</span>
<span id="cb107-7"><a href="#cb107-7" tabindex="-1"></a><span class="fu">print</span>(est_uee_nex)</span></code></pre></div>
<pre><code>## GEE and MAEE for Cluster-Period Summaries 
##  Number of Iterations: 3 
## Results for marginal mean parameters 
##      Beta    Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0 -0.03499108 0.2169350  0.2392903  0.2499507  0.2610881  0.2477876
## [2,]    1 -0.34245090 0.2305101  0.2084051  0.2232474  0.2392423  0.2213878
## [3,]    2 -0.67698816 0.2749173  0.2716631  0.2933535  0.3171098  0.2879913
## [4,]    3  0.02904193 0.3057033  0.1942266  0.2123667  0.2339216  0.2050350
## [5,]    4 -0.43058289 0.3793522  0.1842784  0.2018893  0.2227843  0.2028661
## [6,]    5 -0.81733511 0.2886977  0.2833499  0.3106202  0.3406770  0.3067671
## 
## Results for correlation parameters 
##      Alpha   Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.10499225 0.04215716 0.04379742 0.04550421 0.04378621
## [2,]     1 0.05350042 0.03080632 0.03200335 0.03324877 0.03200919</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" tabindex="-1"></a><span class="co"># exponential decay</span></span>
<span id="cb109-2"><a href="#cb109-2" tabindex="-1"></a>est_uee_ed <span class="ot">&lt;-</span> <span class="fu">cpgeeSWD</span>(</span>
<span id="cb109-3"><a href="#cb109-3" tabindex="-1"></a>  <span class="at">y =</span> y_cp, <span class="at">X =</span> X_cp, <span class="at">id =</span> id_cp,</span>
<span id="cb109-4"><a href="#cb109-4" tabindex="-1"></a>  <span class="at">m =</span> m_cp, <span class="at">corstr =</span> <span class="st">&quot;exp_decay&quot;</span>,</span>
<span id="cb109-5"><a href="#cb109-5" tabindex="-1"></a>  <span class="at">alpadj =</span> <span class="cn">FALSE</span></span>
<span id="cb109-6"><a href="#cb109-6" tabindex="-1"></a>)</span>
<span id="cb109-7"><a href="#cb109-7" tabindex="-1"></a><span class="fu">print</span>(est_uee_ed)</span></code></pre></div>
<pre><code>## GEE and MAEE for Cluster-Period Summaries 
##  Number of Iterations: 4 
## Results for marginal mean parameters 
##      Beta    Estimate MB-stderr BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]    0 -0.03459151 0.2123822  0.2414782  0.2523416  0.2636966  0.2510466
## [2,]    1 -0.33001054 0.2238965  0.2100290  0.2237648  0.2385050  0.2228663
## [3,]    2 -0.66158744 0.2652147  0.2697183  0.2886630  0.3092792  0.2844552
## [4,]    3  0.05115744 0.2911203  0.2127361  0.2279738  0.2454327  0.2231941
## [5,]    4 -0.38956628 0.3612911  0.1403145  0.1497434  0.1617831  0.1547516
## [6,]    5 -0.85722995 0.2692278  0.2336074  0.2555548  0.2796454  0.2493893
## 
## Results for correlation parameters 
##      Alpha  Estimate BC0-stderr BC1-stderr BC2-stderr BC3-stderr
## [1,]     0 0.0989716 0.03850721 0.03997936 0.04151109 0.03993102
## [2,]     1 0.7279137 0.13726650 0.14328210 0.14956972 0.14351625</code></pre>
</div>
</div>
<div id="simbinprobit-example-generating-correlated-binary-data-using-the-multivariate-probit-method" class="section level2">
<h2><code>simbinPROBIT()</code> example: generating correlated binary
data using the multivariate probit method</h2>
<p>The <code>simbinPROBIT()</code> function generates correlated binary
data using the multivariate Probit method <span class="citation">(Emrich
and Piedmonte 1991)</span>. It simulates a vector of binary outcomes
according the specified marginal mean vector and correlation structure.
Constraints and compatibility between the marginal mean and correlation
matrix are checked.</p>
<p>We use the <code>simbinPROBIT()</code> function to generate
correlated binary data with different correlation structures. We
consider simulating a cross-sectional SW-CRT dataset with 2 clusters, 3
periods with the same cluster-period size of 5. We use two mean vectors
for the two clusters and specify the <code>mu</code> argument.</p>
<p>For the exchangeable correlation structure, we specify both the
within-period and inter-period correlation parameters to be
<code>0.015</code>. We use <code>0.03</code> and <code>0.015</code> for
the within-period and inter-period correlations, respectively. The
exponential decay correlation structure has an decay parameter
<code>0.8</code> with the within-period correlation parameter
<code>0.03</code>.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" tabindex="-1"></a><span class="do">#### Simulate 2 clusters, 3 periods and cluster-period size of 5</span></span>
<span id="cb111-2"><a href="#cb111-2" tabindex="-1"></a></span>
<span id="cb111-3"><a href="#cb111-3" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb111-4"><a href="#cb111-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb111-5"><a href="#cb111-5" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb111-6"><a href="#cb111-6" tabindex="-1"></a><span class="co"># means of cluster 1</span></span>
<span id="cb111-7"><a href="#cb111-7" tabindex="-1"></a>u_c1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span>)</span>
<span id="cb111-8"><a href="#cb111-8" tabindex="-1"></a>u1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(u_c1, <span class="fu">c</span>(<span class="fu">rep</span>(m, t)))</span>
<span id="cb111-9"><a href="#cb111-9" tabindex="-1"></a><span class="co"># means of cluster 2</span></span>
<span id="cb111-10"><a href="#cb111-10" tabindex="-1"></a>u_c2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.35</span>, <span class="fl">0.25</span>, <span class="fl">0.2</span>)</span>
<span id="cb111-11"><a href="#cb111-11" tabindex="-1"></a>u2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(u_c2, <span class="fu">c</span>(<span class="fu">rep</span>(m, t)))</span>
<span id="cb111-12"><a href="#cb111-12" tabindex="-1"></a></span>
<span id="cb111-13"><a href="#cb111-13" tabindex="-1"></a><span class="co"># List of mean vectors</span></span>
<span id="cb111-14"><a href="#cb111-14" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb111-15"><a href="#cb111-15" tabindex="-1"></a>mu[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> u1</span>
<span id="cb111-16"><a href="#cb111-16" tabindex="-1"></a>mu[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> u2</span>
<span id="cb111-17"><a href="#cb111-17" tabindex="-1"></a><span class="co"># List of correlation matrices</span></span>
<span id="cb111-18"><a href="#cb111-18" tabindex="-1"></a></span>
<span id="cb111-19"><a href="#cb111-19" tabindex="-1"></a><span class="do">## correlation parameters</span></span>
<span id="cb111-20"><a href="#cb111-20" tabindex="-1"></a>alpha0 <span class="ot">&lt;-</span> <span class="fl">0.03</span></span>
<span id="cb111-21"><a href="#cb111-21" tabindex="-1"></a>alpha1 <span class="ot">&lt;-</span> <span class="fl">0.015</span></span>
<span id="cb111-22"><a href="#cb111-22" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb111-23"><a href="#cb111-23" tabindex="-1"></a></span>
<span id="cb111-24"><a href="#cb111-24" tabindex="-1"></a><span class="do">## (1) exchangeable</span></span>
<span id="cb111-25"><a href="#cb111-25" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb111-26"><a href="#cb111-26" tabindex="-1"></a>Sigma[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">diag</span>(m <span class="sc">*</span> t) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> alpha1) <span class="sc">+</span> <span class="fu">matrix</span>(alpha1, m <span class="sc">*</span> t, m <span class="sc">*</span> t)</span>
<span id="cb111-27"><a href="#cb111-27" tabindex="-1"></a></span>
<span id="cb111-28"><a href="#cb111-28" tabindex="-1"></a>Sigma[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> <span class="fu">diag</span>(m <span class="sc">*</span> t) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> alpha1) <span class="sc">+</span> <span class="fu">matrix</span>(alpha1, m <span class="sc">*</span> t, m <span class="sc">*</span> t)</span>
<span id="cb111-29"><a href="#cb111-29" tabindex="-1"></a></span>
<span id="cb111-30"><a href="#cb111-30" tabindex="-1"></a>y_exc <span class="ot">&lt;-</span> <span class="fu">simbinPROBIT</span>(<span class="at">mu =</span> mu, <span class="at">Sigma =</span> Sigma, <span class="at">n =</span> n)</span>
<span id="cb111-31"><a href="#cb111-31" tabindex="-1"></a></span>
<span id="cb111-32"><a href="#cb111-32" tabindex="-1"></a><span class="do">## (2) nested exchangeable</span></span>
<span id="cb111-33"><a href="#cb111-33" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb111-34"><a href="#cb111-34" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(alpha1, m <span class="sc">*</span> t, m <span class="sc">*</span> t)</span>
<span id="cb111-35"><a href="#cb111-35" tabindex="-1"></a>loc1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb111-36"><a href="#cb111-36" tabindex="-1"></a>loc2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb111-37"><a href="#cb111-37" tabindex="-1"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>t) {</span>
<span id="cb111-38"><a href="#cb111-38" tabindex="-1"></a>  loc1 <span class="ot">&lt;-</span> loc2 <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb111-39"><a href="#cb111-39" tabindex="-1"></a>  loc2 <span class="ot">&lt;-</span> loc1 <span class="sc">+</span> m <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb111-40"><a href="#cb111-40" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> loc1<span class="sc">:</span>loc2) {</span>
<span id="cb111-41"><a href="#cb111-41" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> loc1<span class="sc">:</span>loc2) {</span>
<span id="cb111-42"><a href="#cb111-42" tabindex="-1"></a>      <span class="cf">if</span> (i <span class="sc">!=</span> j) {</span>
<span id="cb111-43"><a href="#cb111-43" tabindex="-1"></a>        cor_matrix[i, j] <span class="ot">&lt;-</span> alpha0</span>
<span id="cb111-44"><a href="#cb111-44" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb111-45"><a href="#cb111-45" tabindex="-1"></a>        cor_matrix[i, j] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb111-46"><a href="#cb111-46" tabindex="-1"></a>      }</span>
<span id="cb111-47"><a href="#cb111-47" tabindex="-1"></a>    }</span>
<span id="cb111-48"><a href="#cb111-48" tabindex="-1"></a>  }</span>
<span id="cb111-49"><a href="#cb111-49" tabindex="-1"></a>}</span>
<span id="cb111-50"><a href="#cb111-50" tabindex="-1"></a></span>
<span id="cb111-51"><a href="#cb111-51" tabindex="-1"></a>Sigma[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> cor_matrix</span>
<span id="cb111-52"><a href="#cb111-52" tabindex="-1"></a>Sigma[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> cor_matrix</span>
<span id="cb111-53"><a href="#cb111-53" tabindex="-1"></a></span>
<span id="cb111-54"><a href="#cb111-54" tabindex="-1"></a>y_nex <span class="ot">&lt;-</span> <span class="fu">simbinPROBIT</span>(<span class="at">mu =</span> mu, <span class="at">Sigma =</span> Sigma, <span class="at">n =</span> n)</span>
<span id="cb111-55"><a href="#cb111-55" tabindex="-1"></a></span>
<span id="cb111-56"><a href="#cb111-56" tabindex="-1"></a><span class="do">## (3) exponential decay</span></span>
<span id="cb111-57"><a href="#cb111-57" tabindex="-1"></a></span>
<span id="cb111-58"><a href="#cb111-58" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb111-59"><a href="#cb111-59" tabindex="-1"></a></span>
<span id="cb111-60"><a href="#cb111-60" tabindex="-1"></a><span class="do">### function to find the period of the ith index</span></span>
<span id="cb111-61"><a href="#cb111-61" tabindex="-1"></a>region_ij <span class="ot">&lt;-</span> <span class="cf">function</span>(points, i) {</span>
<span id="cb111-62"><a href="#cb111-62" tabindex="-1"></a>  diff <span class="ot">&lt;-</span> i <span class="sc">-</span> points</span>
<span id="cb111-63"><a href="#cb111-63" tabindex="-1"></a>  <span class="cf">for</span> (h <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(diff) <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb111-64"><a href="#cb111-64" tabindex="-1"></a>    <span class="cf">if</span> (diff[h] <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> diff[h <span class="sc">+</span> <span class="dv">1</span>] <span class="sc">&lt;=</span> <span class="dv">0</span>) {</span>
<span id="cb111-65"><a href="#cb111-65" tabindex="-1"></a>      find <span class="ot">&lt;-</span> h</span>
<span id="cb111-66"><a href="#cb111-66" tabindex="-1"></a>    }</span>
<span id="cb111-67"><a href="#cb111-67" tabindex="-1"></a>  }</span>
<span id="cb111-68"><a href="#cb111-68" tabindex="-1"></a>  <span class="fu">return</span>(find)</span>
<span id="cb111-69"><a href="#cb111-69" tabindex="-1"></a>}</span>
<span id="cb111-70"><a href="#cb111-70" tabindex="-1"></a></span>
<span id="cb111-71"><a href="#cb111-71" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, m <span class="sc">*</span> t, m <span class="sc">*</span> t)</span>
<span id="cb111-72"><a href="#cb111-72" tabindex="-1"></a>useage_m <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(m <span class="sc">*</span> t)</span>
<span id="cb111-73"><a href="#cb111-73" tabindex="-1"></a>useage_m <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, useage_m)</span>
<span id="cb111-74"><a href="#cb111-74" tabindex="-1"></a></span>
<span id="cb111-75"><a href="#cb111-75" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(m <span class="sc">*</span> t)) {</span>
<span id="cb111-76"><a href="#cb111-76" tabindex="-1"></a>  i_reg <span class="ot">&lt;-</span> <span class="fu">region_ij</span>(useage_m, i)</span>
<span id="cb111-77"><a href="#cb111-77" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(m <span class="sc">*</span> t)) {</span>
<span id="cb111-78"><a href="#cb111-78" tabindex="-1"></a>    j_reg <span class="ot">&lt;-</span> <span class="fu">region_ij</span>(useage_m, j)</span>
<span id="cb111-79"><a href="#cb111-79" tabindex="-1"></a>    <span class="cf">if</span> (i_reg <span class="sc">==</span> j_reg <span class="sc">&amp;</span> i <span class="sc">!=</span> j) {</span>
<span id="cb111-80"><a href="#cb111-80" tabindex="-1"></a>      cor_matrix[i, j] <span class="ot">&lt;-</span> alpha0</span>
<span id="cb111-81"><a href="#cb111-81" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (i <span class="sc">==</span> j) {</span>
<span id="cb111-82"><a href="#cb111-82" tabindex="-1"></a>      cor_matrix[i, j] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb111-83"><a href="#cb111-83" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (i_reg <span class="sc">!=</span> j_reg) {</span>
<span id="cb111-84"><a href="#cb111-84" tabindex="-1"></a>      cor_matrix[i, j] <span class="ot">&lt;-</span> alpha0 <span class="sc">*</span> (rho<span class="sc">^</span>(<span class="fu">abs</span>(i_reg <span class="sc">-</span> j_reg)))</span>
<span id="cb111-85"><a href="#cb111-85" tabindex="-1"></a>    }</span>
<span id="cb111-86"><a href="#cb111-86" tabindex="-1"></a>  }</span>
<span id="cb111-87"><a href="#cb111-87" tabindex="-1"></a>}</span>
<span id="cb111-88"><a href="#cb111-88" tabindex="-1"></a></span>
<span id="cb111-89"><a href="#cb111-89" tabindex="-1"></a>Sigma[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> cor_matrix</span>
<span id="cb111-90"><a href="#cb111-90" tabindex="-1"></a>Sigma[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> cor_matrix</span>
<span id="cb111-91"><a href="#cb111-91" tabindex="-1"></a></span>
<span id="cb111-92"><a href="#cb111-92" tabindex="-1"></a>y_ed <span class="ot">&lt;-</span> <span class="fu">simbinPROBIT</span>(<span class="at">mu =</span> mu, <span class="at">Sigma =</span> Sigma, <span class="at">n =</span> n)</span></code></pre></div>
</div>
<div id="simbinclf-example-generating-correlated-binary-data-using-the-conditional-linear-family-method" class="section level2">
<h2><code>simbinCLF()</code> example: generating correlated binary data
using the conditional linear family method</h2>
<p>The <code>simbinCLF()</code> function generates correlated binary
data using the conditional linear family method <span class="citation">(Qaqish 2003)</span>. It simulates a vector of binary
outcomes according the specified marginal mean vector and correlation
structure. Natural constraints and compatibility between the marginal
mean and correlation matrix are checked.</p>
<p>We use the <code>simbinCLF()</code> function to generate correlated
binary data with different correlation structures. We consider
simulating a cross-sectional SW-CRT dataset with 2 clusters, 3 periods
with the same cluster-period size of 5. We use two mean vectors for the
two clusters and specify the <code>mu</code> argument.</p>
<p>For the exchangeable correlation structure, we specify both the
within-period and inter-period correlation parameters to be
<code>0.015</code>. We use <code>0.03</code> and <code>0.015</code> for
the within-period and inter-period correlations, respectively. The
exponential decay correlation structure has an decay parameter
<code>0.8</code> with the within-period correlation parameter
<code>0.03</code>.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" tabindex="-1"></a><span class="do">##### Simulate 2 clusters, 3 periods and cluster-period size of 5</span></span>
<span id="cb112-2"><a href="#cb112-2" tabindex="-1"></a></span>
<span id="cb112-3"><a href="#cb112-3" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb112-4"><a href="#cb112-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb112-5"><a href="#cb112-5" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb112-6"><a href="#cb112-6" tabindex="-1"></a></span>
<span id="cb112-7"><a href="#cb112-7" tabindex="-1"></a><span class="co"># means of cluster 1</span></span>
<span id="cb112-8"><a href="#cb112-8" tabindex="-1"></a>u_c1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span>)</span>
<span id="cb112-9"><a href="#cb112-9" tabindex="-1"></a>u1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(u_c1, <span class="fu">c</span>(<span class="fu">rep</span>(m, t)))</span>
<span id="cb112-10"><a href="#cb112-10" tabindex="-1"></a><span class="co"># means of cluster 2</span></span>
<span id="cb112-11"><a href="#cb112-11" tabindex="-1"></a>u_c2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.35</span>, <span class="fl">0.25</span>, <span class="fl">0.2</span>)</span>
<span id="cb112-12"><a href="#cb112-12" tabindex="-1"></a>u2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(u_c2, <span class="fu">c</span>(<span class="fu">rep</span>(m, t)))</span>
<span id="cb112-13"><a href="#cb112-13" tabindex="-1"></a></span>
<span id="cb112-14"><a href="#cb112-14" tabindex="-1"></a><span class="co"># List of mean vectors</span></span>
<span id="cb112-15"><a href="#cb112-15" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb112-16"><a href="#cb112-16" tabindex="-1"></a>mu[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> u1</span>
<span id="cb112-17"><a href="#cb112-17" tabindex="-1"></a>mu[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> u2</span>
<span id="cb112-18"><a href="#cb112-18" tabindex="-1"></a><span class="co"># List of correlation matrices</span></span>
<span id="cb112-19"><a href="#cb112-19" tabindex="-1"></a></span>
<span id="cb112-20"><a href="#cb112-20" tabindex="-1"></a><span class="do">## correlation parameters</span></span>
<span id="cb112-21"><a href="#cb112-21" tabindex="-1"></a>alpha0 <span class="ot">&lt;-</span> <span class="fl">0.03</span></span>
<span id="cb112-22"><a href="#cb112-22" tabindex="-1"></a>alpha1 <span class="ot">&lt;-</span> <span class="fl">0.015</span></span>
<span id="cb112-23"><a href="#cb112-23" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb112-24"><a href="#cb112-24" tabindex="-1"></a></span>
<span id="cb112-25"><a href="#cb112-25" tabindex="-1"></a><span class="do">## (1) exchangeable</span></span>
<span id="cb112-26"><a href="#cb112-26" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb112-27"><a href="#cb112-27" tabindex="-1"></a>Sigma[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">diag</span>(m <span class="sc">*</span> t) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> alpha1) <span class="sc">+</span> <span class="fu">matrix</span>(alpha1, m <span class="sc">*</span> t, m <span class="sc">*</span> t)</span>
<span id="cb112-28"><a href="#cb112-28" tabindex="-1"></a>Sigma[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> <span class="fu">diag</span>(m <span class="sc">*</span> t) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> alpha1) <span class="sc">+</span> <span class="fu">matrix</span>(alpha1, m <span class="sc">*</span> t, m <span class="sc">*</span> t)</span>
<span id="cb112-29"><a href="#cb112-29" tabindex="-1"></a>y_exc <span class="ot">&lt;-</span> <span class="fu">simbinCLF</span>(<span class="at">mu =</span> mu, <span class="at">Sigma =</span> Sigma, <span class="at">n =</span> n)</span>
<span id="cb112-30"><a href="#cb112-30" tabindex="-1"></a></span>
<span id="cb112-31"><a href="#cb112-31" tabindex="-1"></a><span class="do">## (2) nested exchangeable</span></span>
<span id="cb112-32"><a href="#cb112-32" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb112-33"><a href="#cb112-33" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(alpha1, m <span class="sc">*</span> t, m <span class="sc">*</span> t)</span>
<span id="cb112-34"><a href="#cb112-34" tabindex="-1"></a>loc1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb112-35"><a href="#cb112-35" tabindex="-1"></a>loc2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb112-36"><a href="#cb112-36" tabindex="-1"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>t) {</span>
<span id="cb112-37"><a href="#cb112-37" tabindex="-1"></a>  loc1 <span class="ot">&lt;-</span> loc2 <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb112-38"><a href="#cb112-38" tabindex="-1"></a>  loc2 <span class="ot">&lt;-</span> loc1 <span class="sc">+</span> m <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb112-39"><a href="#cb112-39" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> loc1<span class="sc">:</span>loc2) {</span>
<span id="cb112-40"><a href="#cb112-40" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> loc1<span class="sc">:</span>loc2) {</span>
<span id="cb112-41"><a href="#cb112-41" tabindex="-1"></a>      <span class="cf">if</span> (i <span class="sc">!=</span> j) {</span>
<span id="cb112-42"><a href="#cb112-42" tabindex="-1"></a>        cor_matrix[i, j] <span class="ot">&lt;-</span> alpha0</span>
<span id="cb112-43"><a href="#cb112-43" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb112-44"><a href="#cb112-44" tabindex="-1"></a>        cor_matrix[i, j] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb112-45"><a href="#cb112-45" tabindex="-1"></a>      }</span>
<span id="cb112-46"><a href="#cb112-46" tabindex="-1"></a>    }</span>
<span id="cb112-47"><a href="#cb112-47" tabindex="-1"></a>  }</span>
<span id="cb112-48"><a href="#cb112-48" tabindex="-1"></a>}</span>
<span id="cb112-49"><a href="#cb112-49" tabindex="-1"></a></span>
<span id="cb112-50"><a href="#cb112-50" tabindex="-1"></a>Sigma[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> cor_matrix</span>
<span id="cb112-51"><a href="#cb112-51" tabindex="-1"></a>Sigma[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> cor_matrix</span>
<span id="cb112-52"><a href="#cb112-52" tabindex="-1"></a>y_nex <span class="ot">&lt;-</span> <span class="fu">simbinCLF</span>(<span class="at">mu =</span> mu, <span class="at">Sigma =</span> Sigma, <span class="at">n =</span> n)</span>
<span id="cb112-53"><a href="#cb112-53" tabindex="-1"></a></span>
<span id="cb112-54"><a href="#cb112-54" tabindex="-1"></a><span class="do">## (3) exponential decay</span></span>
<span id="cb112-55"><a href="#cb112-55" tabindex="-1"></a></span>
<span id="cb112-56"><a href="#cb112-56" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb112-57"><a href="#cb112-57" tabindex="-1"></a></span>
<span id="cb112-58"><a href="#cb112-58" tabindex="-1"></a><span class="do">### function to find the period of the ith index</span></span>
<span id="cb112-59"><a href="#cb112-59" tabindex="-1"></a>region_ij <span class="ot">&lt;-</span> <span class="cf">function</span>(points, i) {</span>
<span id="cb112-60"><a href="#cb112-60" tabindex="-1"></a>  diff <span class="ot">&lt;-</span> i <span class="sc">-</span> points</span>
<span id="cb112-61"><a href="#cb112-61" tabindex="-1"></a>  <span class="cf">for</span> (h <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(diff) <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb112-62"><a href="#cb112-62" tabindex="-1"></a>    <span class="cf">if</span> (diff[h] <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> diff[h <span class="sc">+</span> <span class="dv">1</span>] <span class="sc">&lt;=</span> <span class="dv">0</span>) {</span>
<span id="cb112-63"><a href="#cb112-63" tabindex="-1"></a>      find <span class="ot">&lt;-</span> h</span>
<span id="cb112-64"><a href="#cb112-64" tabindex="-1"></a>    }</span>
<span id="cb112-65"><a href="#cb112-65" tabindex="-1"></a>  }</span>
<span id="cb112-66"><a href="#cb112-66" tabindex="-1"></a>  <span class="fu">return</span>(find)</span>
<span id="cb112-67"><a href="#cb112-67" tabindex="-1"></a>}</span>
<span id="cb112-68"><a href="#cb112-68" tabindex="-1"></a></span>
<span id="cb112-69"><a href="#cb112-69" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, m <span class="sc">*</span> t, m <span class="sc">*</span> t)</span>
<span id="cb112-70"><a href="#cb112-70" tabindex="-1"></a>useage_m <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(m <span class="sc">*</span> t)</span>
<span id="cb112-71"><a href="#cb112-71" tabindex="-1"></a>useage_m <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, useage_m)</span>
<span id="cb112-72"><a href="#cb112-72" tabindex="-1"></a></span>
<span id="cb112-73"><a href="#cb112-73" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(m <span class="sc">*</span> t)) {</span>
<span id="cb112-74"><a href="#cb112-74" tabindex="-1"></a>  i_reg <span class="ot">&lt;-</span> <span class="fu">region_ij</span>(useage_m, i)</span>
<span id="cb112-75"><a href="#cb112-75" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(m <span class="sc">*</span> t)) {</span>
<span id="cb112-76"><a href="#cb112-76" tabindex="-1"></a>    j_reg <span class="ot">&lt;-</span> <span class="fu">region_ij</span>(useage_m, j)</span>
<span id="cb112-77"><a href="#cb112-77" tabindex="-1"></a>    <span class="cf">if</span> (i_reg <span class="sc">==</span> j_reg <span class="sc">&amp;</span> i <span class="sc">!=</span> j) {</span>
<span id="cb112-78"><a href="#cb112-78" tabindex="-1"></a>      cor_matrix[i, j] <span class="ot">&lt;-</span> alpha0</span>
<span id="cb112-79"><a href="#cb112-79" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (i <span class="sc">==</span> j) {</span>
<span id="cb112-80"><a href="#cb112-80" tabindex="-1"></a>      cor_matrix[i, j] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb112-81"><a href="#cb112-81" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (i_reg <span class="sc">!=</span> j_reg) {</span>
<span id="cb112-82"><a href="#cb112-82" tabindex="-1"></a>      cor_matrix[i, j] <span class="ot">&lt;-</span> alpha0 <span class="sc">*</span> (rho<span class="sc">^</span>(<span class="fu">abs</span>(i_reg <span class="sc">-</span> j_reg)))</span>
<span id="cb112-83"><a href="#cb112-83" tabindex="-1"></a>    }</span>
<span id="cb112-84"><a href="#cb112-84" tabindex="-1"></a>  }</span>
<span id="cb112-85"><a href="#cb112-85" tabindex="-1"></a>}</span>
<span id="cb112-86"><a href="#cb112-86" tabindex="-1"></a></span>
<span id="cb112-87"><a href="#cb112-87" tabindex="-1"></a>Sigma[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> cor_matrix</span>
<span id="cb112-88"><a href="#cb112-88" tabindex="-1"></a>Sigma[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> cor_matrix</span>
<span id="cb112-89"><a href="#cb112-89" tabindex="-1"></a></span>
<span id="cb112-90"><a href="#cb112-90" tabindex="-1"></a>y_ed <span class="ot">&lt;-</span> <span class="fu">simbinCLF</span>(<span class="at">mu =</span> mu, <span class="at">Sigma =</span> Sigma, <span class="at">n =</span> n)</span></code></pre></div>
</div>
<div id="session-information" class="section level1">
<h1>Session Information</h1>
<pre><code>## R version 4.2.2 (2022-10-31)
## Platform: aarch64-apple-darwin20 (64-bit)
## Running under: macOS 14.2.1
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] C/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] geeCRT_1.1.3
## 
## loaded via a namespace (and not attached):
##  [1] mvtnorm_1.1-3     digest_0.6.31     MASS_7.3-58.1     R6_2.5.1          jsonlite_1.8.4   
##  [6] rootSolve_1.8.2.3 evaluate_0.20     cachem_1.0.7      rlang_1.0.6       cli_3.6.0        
## [11] rstudioapi_0.14   jquerylib_0.1.4   bslib_0.4.2       rmarkdown_2.20    tools_4.2.2      
## [16] xfun_0.37         yaml_2.3.7        fastmap_1.1.1     compiler_4.2.2    htmltools_0.5.4  
## [21] knitr_1.42        sass_0.4.5</code></pre>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-emrich1991method" class="csl-entry">
Emrich, Lawrence J, and Marion R Piedmonte. 1991. <span>“A Method for
Generating High-Dimensional Multivariate Binary Variates.”</span>
<em>The American Statistician</em> 45 (4): 302–4.
</div>
<div id="ref-li2018sample" class="csl-entry">
Li, Fan, Elizabeth L Turner, and John S Preisser. 2018. <span>“Sample
Size Determination for GEE Analyses of Stepped Wedge Cluster Randomized
Trials.”</span> <em>Biometrics</em> 74 (4): 1450–58.
</div>
<div id="ref-li2022marginal" class="csl-entry">
Li, Fan, Hengshi Yu, Paul J Rathouz, Elizabeth L Turner, and John S
Preisser. 2022. <span>“Marginal Modeling of Cluster-Period Means and
Intraclass Correlations in Stepped Wedge Designs with Binary
Outcomes.”</span> <em>Biostatistics</em> 23 (3): 772–88.
</div>
<div id="ref-preisser2008finite" class="csl-entry">
Preisser, John S, Bing Lu, and Bahjat F Qaqish. 2008. <span>“Finite
Sample Adjustments in Estimating Equations and Covariance Estimators for
Intracluster Correlations.”</span> <em>Statistics in Medicine</em> 27
(27): 5764–85.
</div>
<div id="ref-qaqish2003family" class="csl-entry">
Qaqish, Bahjat F. 2003. <span>“A Family of Multivariate Binary
Distributions for Simulating Correlated Binary Variables with Specified
Marginal Means and Correlations.”</span> <em>Biometrika</em> 90 (2):
455–63.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
